function AgenciasController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/agencias/php/getAgencias.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.agencias=a,o.dataLoading=!1,o.totalItems=o.agencias.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.agencias=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/agencias/php/deleteAgencia.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarAgencia=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.agencias,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AnniosController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/annios/php/getAnnios.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.annios=a,o.dataLoading=!1,o.totalItems=o.annios.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.dataLoading=!1,o.annios=[]}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/annios/php/deleteAnnios.php",{valor:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarAnnios=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.annios,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function BandejaAdministradorController(o,e,a,r,n,t,s){e.user&&e.rolesProcesos&&e.rolesMantenimientos||r.path("/home"),o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},o.user=e.user,o.rolesProcesos=e.rolesProcesos,o.rolesMantenimientos=e.rolesMantenimientos,function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?n.post("app/bandejaEntrada/php/getBandejaAdmin.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaEntrada=a,o.totalItems=o.bandejaEntrada.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaEntrada=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")}(),o.cargarTodos=function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?n.post("app/bandejaEntrada/php/getBandejaAdminTodos.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaEntrada=a,o.totalItems=o.bandejaEntrada.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaEntrada=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")},o.resetFilters=function(){o.search={},o.selected="5",o.selectedTipo="2"},o.changeSearch=function(){switch(option=o.selected,option){case"0":return o.search.id_estado=0;case"1":return o.search.id_estado=1;case"2":return o.search.id_estado=2;case"3":return o.search.id_estado=3;default:return o.search.id_estado=""}},o.changeTipoSearch=function(){switch(option=o.selectedTipo,option){case"0":return o.search.id_tipo_prestamo=0;case"1":return o.search.id_tipo_prestamo=1;default:return o.search.id_tipo_prestamo=""}},o.$watch("search",function(e,a){o.filtered=s(o.bandejaEntrada,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AreasCreditoController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/areasCredito/php/getAreasCredito.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.areasCredito=a,o.dataLoading=!1,o.totalItems=o.areasCredito.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.areasCredito=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/areasCredito/php/deleteAreaCredito.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar porque tiene detalles asociados"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarAreaCredito=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.areasCredito,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function BandejaController(o,e,a,r,n,t,s){e.user&&e.rolesProcesos&&e.rolesMantenimientos||r.path("/home"),o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},o.user=e.user,o.rolesProcesos=e.rolesProcesos,o.rolesMantenimientos=e.rolesMantenimientos,function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?1==e.user.idtipo_usuario?n.post("app/bandejaEntrada/php/getBandejaAdmin.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaEntrada=a,o.totalItems=o.bandejaEntrada.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaEntrada=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):n.post("app/bandejaEntrada/php/getBandejaUser.php",{idUser:e.user.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaEntrada=a,o.totalItems=o.bandejaEntrada.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaEntrada=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")}(),o.cargarTodos=function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?1==e.user.idtipo_usuario?n.post("app/bandejaEntrada/php/getBandejaAdminTodos.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaEntrada=a,o.totalItems=o.bandejaEntrada.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaEntrada=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):n.post("app/bandejaEntrada/php/getBandejaUserTodos.php",{idUser:e.user.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaEntrada=a,o.totalItems=o.bandejaEntrada.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaEntrada=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")},o.resetFilters=function(){o.search={},o.selected="5",o.selectedTipo="2"},o.changeSearch=function(){switch(option=o.selected,option){case"0":return o.search.id_estado=0;case"1":return o.search.id_estado=1;case"2":return o.search.id_estado=2;case"3":return o.search.id_estado=3;default:return o.search.id_estado=""}},o.changeTipoSearch=function(){switch(option=o.selectedTipo,option){case"0":return o.search.id_tipo_prestamo=0;case"1":return o.search.id_tipo_prestamo=1;default:return o.search.id_tipo_prestamo=""}},o.$watch("search",function(e,a){o.filtered=s(o.bandejaEntrada,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function BandejaLeadsController(o,e,a,r,n,t,s){e.user&&e.rolesProcesos&&e.rolesMantenimientos||r.path("/home"),o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},o.user=e.user,o.rolesProcesos=e.rolesProcesos,o.rolesMantenimientos=e.rolesMantenimientos,function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?n.post("app/bandejaLeads/php/getBandejaLeads.php",{idUser:e.user.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaLeads=a,o.totalItems=o.bandejaLeads.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaLeads=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")}(),o.cargarTodos=function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?n.post("app/bandejaLeads/php/getBandejaLeadsTodos.php",{idUser:e.user.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaLeads=a,o.totalItems=o.bandejaLeads.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaLeads=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")},o.resetFilters=function(){o.search={}},o.changeSearch=function(){switch(option=o.selected,option){case"0":return o.search.id_estado=0;case"1":return o.search.id_estado=1;case"2":return o.search.id_estado=2;case"3":return o.search.id_estado=3;default:return o.search.id_estado=""}},o.$watch("search",function(e,a){o.filtered=s(o.bandejaLeads,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function BandejaVendedorController(o,e,a,r,n,t,s){e.user&&e.rolesProcesos&&e.rolesMantenimientos||r.path("/home"),o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},o.user=e.user,o.rolesProcesos=e.rolesProcesos,o.rolesMantenimientos=e.rolesMantenimientos,function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?n.post("app/bandejaVendedor/php/getBandejaVendedor.php",{idUser:e.user.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaVendedor=a,o.totalItems=o.bandejaVendedor.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaVendedor=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")}(),o.cargarTodos=function(){o.dataLoading=!0,e.user&&e.rolesProcesos&&e.rolesMantenimientos?n.post("app/bandejaVendedor/php/getBandejaVendedorTodos.php",{idUser:e.user.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bandejaVendedor=a,o.totalItems=o.bandejaVendedor.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.dataLoading=!1}else o.bandejaVendedor=[],o.dataLoading=!1}).error(function(e,a){console.log(e),o.dataLoading=!1}):r.path("/home")},o.resetFilters=function(){o.search={},o.selected="5",o.selectedTipo="2"},o.changeSearch=function(){switch(option=o.selected,option){case"0":return o.search.id_estado=0;case"1":return o.search.id_estado=1;case"2":return o.search.id_estado=2;case"3":return o.search.id_estado=3;default:return o.search.id_estado=""}},o.changeTipoSearch=function(){switch(option=o.selectedTipo,option){case"0":return o.search.id_tipo_prestamo=0;case"1":return o.search.id_tipo_prestamo=1;default:return o.search.id_tipo_prestamo=""}},o.$watch("search",function(e,a){o.filtered=s(o.bandejaVendedor,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function BonificacionesController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/bonificaciones/php/getBonificaciones.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.bonificaciones=a,o.dataLoading=!1,o.totalItems=o.bonificaciones.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.bonificaciones=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/bonificaciones/php/deleteBonificacion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarBonificacion=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.bonificaciones,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function EjecutivoController(o,e,a,r,n,t,s,c,l,d,p,u,g,m,f,h){function P(){var e=t.defer(),a=e.promise,r=o.salarioBruto-o.salarioNeto,i=o.costoConGastos-o.gastosVehiculo,s=0;return s=(o.tipoVehiculoComprar,1),atributos={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",primerNombreCliente:o.nombre,segundoNombreCliente:o.nombre,primerApellidoCliente:o.apellido1,segundoApellidoCliente:o.apellido2,nombreEmpresa:"",tipoIdentificacion:18,numeroIdentificacion:o.cedula,fechaNacimiento:o.fechaNacimiento,segmentoCotizador:1,antiguedadLaboral:o.fechaIngreso,ingresoActual:o.salarioBruto,gastos:r,tipoVehiculo:s,cuotaSolicitada:0,montoSolicitado:c.calcularSaldoFinanciar(o.costoConGastos,o.costoConGastos*(o.prima/100)),precioVehiculo:i},n.post("app/php/soapServicePreAprobarMonto.php",atributos).success(function(a){angular.isObject(a)?e.resolve(a.return):(o.error="No se pudo crear",e.reject(o.error))}).error(function(a,r){o.error="No se pudo crear",e.reject(a)}),a}function v(e,a){var r=t.defer(),i=r.promise,e={email:e,subject:"CORREO DE COTIZACION DE VEHICULO",message:"Cotizacion rapida de vehiculos",data:a};return n.post("app/php/emailRapidoConArchivo.php",e).success(function(e){angular.isObject(e),o.dataLoading=!1,r.resolve()}).error(function(o,e){console.log(o),r.reject(o)}),i}function b(){o.montoLoJackDeCuota=0,"0"==o.tipoPrestamo?C():F()}function C(){var e=[];e.push(o.selectedExtra);var a=o.costoConGastos-o.gastosVehiculo,r=L(o.libre,o.prima),i=o.costoConGastos-parseFloat(r),n=i*(o.detallesPDF.comisionBancaria/100),t=S(o.detallesPDF,e,o.extrasPromocion),s=c.calcularSeguroDeudaTotal(i,o.detallesPDF.factorSeguro);1!=o.deudorTipo&&2!=o.deudorTipo||(s=0);var l=c.calcularSubTotalSeguro(o.detallesPDF.cambio_dolar,o.detallesPDF.cambio_dolar_seguros,e,o.extrasPromocion,o.detallesPDF.nombreMoneda,a,o.detallesPDF.a,o.detallesPDF.b,o.detallesPDF.c,o.detallesPDF.d,o.detallesPDF.f,o.detallesPDF.g,o.detallesPDF.h),d=c.calcularFinanciamientoSeguro(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,l,o.selectedBonificacion.seguro),p=c.calcularSeguroVehiculo(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,l,o.selectedBonificacion.seguro);"Placa - Bus"==o.detallesPDF.nombreTipoVehiculo&&(p=-1*c.PMT(o.detallesPDF.tasa3/100,12,6*p)),o.seguroVehiculo=p;var u=_(t),g=parseFloat(i)+parseFloat(u)+parseFloat(d)+parseFloat(n)+parseFloat(s);o.saldoAFinanciar=g,z(o.detallesPDF),o.calcularLoading=!1}function F(){var e=[];e.push(o.selectedExtra);var a=o.costoConGastos-o.gastosVehiculo,r=L(o.libre,o.prima),n=o.costoConGastos-parseFloat(r),t=n*(o.detallesPDF.comisionBancaria/100),s=S(o.detallesPDF,e,o.extrasPromocion),l=c.calcularSeguroDeudaTotal(n,o.detallesPDF.factorSeguro);1!=o.deudorTipo&&2!=o.deudorTipo||(l=0);var d=c.calcularSubTotalSeguroLeasing(o.detallesPDF.cambio_dolar,o.detallesPDF.cambio_dolar_seguros,e,o.extrasPromocion,o.detallesPDF.nombreMoneda,a,o.detallesPDF.a,o.detallesPDF.b,o.detallesPDF.c,o.detallesPDF.d,o.detallesPDF.f,o.detallesPDF.g,o.detallesPDF.h),p=c.calcularFinanciamientoSeguroLeasing(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,d,"0"),u=c.calcularSeguroVehiculoLeasing(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,d,"0");"Placa - Bus"==o.detallesPDF.nombreTipoVehiculo&&(u=-1*c.PMT(o.detallesPDF.tasa3/100,12,6*u)),o.seguroVehiculo=u;var g=_(s),m=parseFloat(n)+parseFloat(g)+parseFloat(p)+parseFloat(t)+parseFloat(l);for(o.saldoAFinanciar=m,i=0;i<s.length;i++)palabraMayuscula=s[i].descripcion.toUpperCase(),palabraMayuscula.search("LOJACK")>=0&&(o.montoLoJackDeCuota=s[i].cuota);z(o.detallesPDF),o.calcularLoading=!1}function L(e,a){if(0==e)return o.porcentajePrima=a,o.costoConGastos*(a/100);var r=o.costoConGastos*(a/100);return o.porcentajePrima=((parseFloat(r)+parseFloat(e))/o.costoConGastos*100).toFixed(2),o.costoConGastos*(a/100)+parseFloat(e)}function A(){var a=t.defer(),r=a.promise,i={idPromocion:o.selectedPromocion.id,modelo:o.selectedModelo.modelo,tipo_seguro:o.tipoVehiculoComprar,annio:o.selectedAnnio.anno,moneda:o.selectedMoneda.id_moneda,usoSeguro:o.usoSeguro};return n.post("app/ejecutivo/php/getDetallePDF.php",i).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],o.detallesPDF.id_moneda=o.selectedMoneda.id_moneda,o.detallesPDF.id_tipopersona=o.deudorTipo,d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),r}function j(){var a=t.defer(),r=a.promise,i={idPromocion:o.selectedPromocion.id,modelo:o.selectedModelo.modelo,annio:o.selectedAnnio.anno,moneda:o.selectedMoneda.id_moneda,usoSeguro:o.usoSeguro};return n.post("app/ejecutivo/php/getDetalleLeasingPDF.php",i).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],o.detallesPDF.id_moneda=o.selectedMoneda.id_moneda,o.detallesPDF.id_tipopersona=o.deudorTipo,d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),r}function z(o){o.subsidioSeguro>0&&o.subsidioTasa>0?w(o):o.subsidioSeguro>0&&o.periodosGracia>0||o.periodosGracia>0&&o.subsidioTasa>0||(o.periodosGracia>0?H(o):o.subsidioTasa>0?tabla=W(o):o.subsidioSeguro>0?q(o):tabla=W(o))}function D(){var e=t.defer(),a=e.promise;return o.extrasPromocion=[],o.selectedPromocion?n.post("app/promociones/agregarDetalle/php/getExtrasByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasPromocion=r,e.resolve()}else o.extrasPromocion=[],e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):e.resolve(),a}function S(o,e,a){var r=[];if(0==e.length&&0==a.length){var n={descripcion:"Sin extras",monto:0,cuota:0};r.push(n)}else{if(e.length>0)for(i=0;i<e.length;i++){var n={};n.descripcion=e[i].descripcion,n.monto=M(o,e[i]),n.cuota=O(o,e[i]),r.push(n)}if(a.length>0)for(i=0;i<a.length;i++){var n={};n.descripcion=a[i].descripcion,n.monto=M(o,a[i]),n.cuota=O(o,a[i]),r.push(n)}}return r}function M(o,e){var a;return 1==o.id_moneda&&1==e.moneda&&(a=e.monto),2==o.id_moneda&&2==e.moneda&&(a=e.monto),1==o.id_moneda&&2==e.moneda&&(a=e.monto/o.cambio_dolar),2==o.id_moneda&&1==e.moneda&&(a=e.monto*o.cambio_dolar),parseFloat(a)}function O(o,e){var a;return 1==o.id_moneda&&1==e.moneda&&(a=e.cuota),2==o.id_moneda&&2==e.moneda&&(a=e.cuota),1==o.id_moneda&&2==e.moneda&&(a=e.cuota/o.cambio_dolar),2==o.id_moneda&&1==e.moneda&&(a=e.cuota*o.cambio_dolar),parseFloat(a)}function _(o){var e=0;for(i=0;i<o.length;i++)e+=o[i].monto;return parseFloat(e)}function $(){x()}function x(){o.marcasLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/marcas/php/getMarcas.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.marcas=r,o.marcasLoading=!1,e.resolve()}else o.marcas=[],o.marcasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function E(){o.plazosPromocion=[],o.plazosPromocion.push(o.seccion.plazo1),o.plazosPromocion.push(o.seccion.plazo1-12),o.plazosPromocion.push(o.seccion.plazo1-24),o.plazosPromocion.push(o.seccion.plazo1-36),o.selectedPlazo=o.plazosPromocion[0]}function T(){o.selectedPromocion&&n.post("app/vendedor/php/getSeccionByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(e){if(angular.isObject(e)){var a={};for(i=0;i<e.length;i++){a=JSON.parse(e[i])[0]}o.seccion=a,o.prima=parseFloat(a.porcentaje),E()}else o.seccion={}}).error(function(o,e){console.log(o)})}function I(){o.monedasLoading=!0,o.monedas=[],o.selectedPromocion?n.post("app/vendedor/php/getMonedasByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.monedas=a,o.selectedMoneda=o.monedas[0],o.monedasLoading=!1}else o.monedas=[],o.monedasLoading=!1}).error(function(o,e){console.log(o)}):o.monedasLoading=!1}function N(){o.anniosLoading=!0,o.annios=[],o.selectedPromocion?n.post("app/vendedor/php/getAnniosByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.annios=a,o.selectedAnnio=o.annios[0],o.anniosLoading=!1}else o.annios=[],o.anniosLoading=!1}).error(function(o,e){console.log(o)}):o.anniosLoading=!1}function B(){V()}function V(){o.marcasLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/vendedor/php/getMarcasByUsuario.php",{idUsuario:o.user.id}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0]),palabraMayuscula=n[0].descripcion.toUpperCase().trim(),palabraMayuscula.search("CREDIAUTOS")>=0||palabraMayuscula.search("NOVACIONES")>=0||palabraMayuscula.search("TERCEROS")>=0?(o.tipoVehiculoComprar="2",o.disableTipoVehiculoComprar=!0):(o.tipoVehiculoComprar="1",o.disableTipoVehiculoComprar=!0)}o.marcas=r,o.marcasLoading=!1,e.resolve()}else o.marcas=[],o.marcasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function R(){var e=t.defer(),a=e.promise,r={id_bandeja:o.idCotizacion,id_extra:o.selectedExtra.id};return n.post("app/vendedor/php/agregarExtraBandeja.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}function U(e){var a=t.defer(),r=a.promise,i=(o.costoConGastos,o.gastosVehiculo,{id_bandeja:e,id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2});return n.post("app/vendedor/php/agregarSolicitud.php",i).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}function J(e,a,r,i,c,l){var d=t.defer(),p=d.promise,u=s.mensaje(e,a,r,i),i={email:i,subject:"CORREO DE PREAPROBACION DE VEHICULO",message:u,data:c,cartaPreAprobacion:l};return n.post("app/php/enviarEmailPreAprobacion.php",i).success(function(e){angular.isObject(e),o.dataLoading=!1,d.resolve()}).error(function(o,e){console.log(o),d.reject(o)}),p}function G(e,a,r,i,c,l){var d=t.defer(),p=d.promise,u=s.mensaje(e,a,r,i),i={email:i,subject:"CORREO DE PREAPROBACION DE VEHICULO",message:u,data:c,cartaNoPreAprobacion:l};return n.post("app/php/enviarEmailNoPreAprobacion.php",i).success(function(e){angular.isObject(e),o.dataLoading=!1,d.resolve()}).error(function(o,e){console.log(o),d.reject(o)}),p}function k(){o.cedula=null,o.nombre=null,o.apellido1=null,o.apellido2=null,o.correo=null,o.telefono=null,o.salarioBruto=null,o.salarioNeto=null,o.gastos=null,o.prima=null,o.montoPrima=null,o.cuota1=null,o.cuota2=null,o.idCotizacion=null,o.seccion={},o.fechaNacimiento=null,o.fechaIngreso=null,o.cuota3=null,o.gastosVehiculo=null,o.costoConGastos=null,o.placaVehiculo=null,o.selectedPromocion=null,o.form.$setPristine()}function y(){var e=t.defer(),a=e.promise,r="?";"CREDIAUTOS"!=o.selectedMarca.descripcion&&"NOVACIONES"!=o.selectedMarca.descripcion&&"TERCEROS"!=o.selectedMarca.descripcion||(r=o.placaVehiculo);var i=o.salarioBruto-o.salarioNeto,s=o.costoConGastos-o.gastosVehiculo,c={agencia:o.selectedAgencia.id,id_tipo_prestamo:parseFloat(o.tipoPrestamo),id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,fecha_nacimiento:o.fechaNacimiento,antiguedad_laboral:o.fechaIngreso,email:o.correo,telefono:o.telefono,id_estado:o.resultadoPreAprobacion,anno:o.selectedAnnio.anno,ingresobruto:o.salarioBruto,ingreso:o.salarioNeto,gastos:i,tipo_vehiculo_a_comprar:o.tipoVehiculoComprar,costovehiculo:s,preciocongastos:o.costoConGastos,gastosvehiculo:o.gastosVehiculo,prima:o.prima,libre:o.montoPrima,plazo:o.selectedPlazo,id_promocion:o.selectedPromocion.id,id_marca:o.selectedMarca.id,id_marca_modelo:o.selectedModelo.modelo,placa:r,id_usuario:o.user.id};return n.post("app/vendedor/php/agregarCotizacion.php",c).success(function(a){angular.isObject(a)&&a.jsonSuccess?(o.idCotizacion=a.last_id,e.resolve()):(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}function w(e){if(12==parseFloat(e.subsidioSeguro)){plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodoSubsidioSeguro(o.saldoAFinanciar,e.tasa1,parseFloat(plazo1),strPMT1,parseFloat(e.subsidioSeguro))),strPMT3=-1*c.PMT(i,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa2,plazo2Diferencia+parseFloat(e.subsidioSeguro),strPMT2)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+0).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2)}else{plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar);var n=12-(parseFloat(plazo1)+parseFloat(e.subsidioSeguro));strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodoSubsidioSeguro(o.saldoAFinanciar,e.tasa1,parseFloat(plazo1)+parseFloat(e.subsidioSeguro)+n,strPMT1,parseFloat(e.subsidioSeguro))),strPMT3=-1*c.PMT(i,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa2,plazo2Diferencia+parseFloat(e.subsidioSeguro),strPMT2)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+0).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}}function q(e){plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodoSubsidioSeguro(o.saldoAFinanciar,e.tasa1,parseFloat(plazo1)+parseFloat(e.subsidioSeguro),strPMT1,parseFloat(e.subsidioSeguro))),strPMT3=-1*c.PMT(i,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa2,plazo2Diferencia+parseFloat(e.subsidioSeguro),strPMT2)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+0).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}function H(e){plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=o.saldoAFinanciar*(parseFloat(e.tasa2)/100)/12*parseFloat(e.periodosGracia);o.saldoAFinanciar=o.saldoAFinanciar+a;var r=c.calcularTasa(e.tasa1),i=c.calcularTasa(e.tasa2),n=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(r,e.plazo1,o.saldoAFinanciar),cuotaPorPeriodoGracia=0,strPMT2=-1*c.PMT(i,e.plazo2,o.saldoAFinanciar),strPMT3=-1*c.PMT(n,e.plazo3,c.calculaPagoPeriodoDeGracia(o.saldoAFinanciar,e.tasa2,parseFloat(plazo2Diferencia)+parseFloat(e.periodosGracia),strPMT2,parseFloat(plazo2Diferencia))),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}function W(o){o.tasa2==o.tasa3&&K(o),o.tasa1==o.tasa2&&Y(o),o.tasa1==o.tasa2&&o.tasa1==o.tasa3&&o.tasa2==o.tasa3&&(tabla=Z(o)),o.tasa1!=o.tasa2&&o.tasa2!=o.tasa3&&Q(o)}function Z(e){var a=c.calcularTasa(e.tasa1);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),
o.cuota1=cuotaFinal1,o.cuota2=null,o.cuota3=null}function K(e){plazo1=e.plazo1-e.plazo2,plazoRestante=plazo1+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa1,plazo1,strPMT1)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2}function Y(e){plazo1=e.plazo1-e.plazo3,plazoRestante=plazo1+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa1,plazo1,strPMT1)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2}function Q(e){plazo1=e.plazo1-e.plazo2,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,o.saldoAFinanciar),strPMT3=-1*c.PMT(i,e.plazo3,o.saldoAFinanciar),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}o.imgLoading=a.img,o.seccion={},o.esUsado=!1,o.libre=0,o.usoSeguro="0",o.tipoPrestamo="0",o.prendarioTrue=!0,o.deudorTipo="0",o.disableTipoVehiculoComprar=!1,e.user&&e.rolesProcesos&&e.rolesMantenimientos?(function(){o.agenciasLoading=!0;var a=t.defer(),r=a.promise;n.post("app/usuarios/editarUsuario/php/getAgenciasByUsuario.php",{idUsuario:e.user.id}).success(function(e){if(angular.isObject(e)){var r=[];for(i=0;i<e.length;i++){var n=JSON.parse(e[i]);r.push(n[0])}o.agencias=r,o.selectedAgencia=o.agencias[0],o.agenciasLoading=!1,a.resolve()}else o.agencias=[],o.agenciasLoading=!1,a.reject()}).error(function(o,e){console.log(o),a.reject(o)})}(),function(){var e=t.defer(),a=e.promise;o.bonificacionesLoading=!0,o.bonificaciones=[],n.post("app/bonificaciones/php/getBonificaciones.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}for(o.bonificaciones=r,i=0;i<o.bonificaciones.length;i++)-45==o.bonificaciones[i].seguro&&(o.selectedBonificacion=o.bonificaciones[i]);o.bonificacionesLoading=!1,e.resolve()}else o.bonificaciones=[],o.bonificacionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)})}(),function(){e.user&&e.rolesProcesos&&e.rolesMantenimientos?1==e.rolesProcesos[0].admin||1==e.rolesMantenimientos[0].admin?$():B():r.path("/home")}(),function(){n.post("app/vendedor/php/getLoJack.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.extras=a,o.selectedExtra=o.extras[0]}else o.extras=[]}).error(function(o,e){console.log(o)})}()):r.path("/home"),o.consultarCedula=function(){o.consultarCedulaLoading=!0,persona={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",numeroIdentificacion:o.cedula},n.post("app/php/soapServiceValidarIdentificacion.php",persona).success(function(e){angular.isObject(e)&&"EMPTY"!=e.return.resultado?(o.nombre=e.return.nombres.trim(),o.apellido1=e.return.apellido1.trim(),o.apellido2=e.return.apellido2.trim(),o.consultarCedulaLoading=!1):(o.error="No existe",alert("La cedula no existe"),o.consultarCedulaLoading=!1)}).error(function(e,a){alert("No se pudo consultar"),o.consultarCedulaLoading=!1})},o.consultarIsuzu=function(){o.mensajeIsuzu="",o.cedulaIsuzuLoading=!0,atributos={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",numeroIdentificacion:o.cedula},n.post("app/php/soapServicePreaprobarCedula.php",atributos).success(function(e){"0"==e.return?o.mensajeIsuzu="No presenta anotaciones negativas":"3"==e.return?o.mensajeIsuzu="Cedula no registrada":o.mensajeIsuzu="Presenta anotaciones negativas",o.cedulaIsuzuLoading=!1}).error(function(e,a){o.error="No se pudo consultar",o.cedulaIsuzuLoading=!1})},o.openRapidaPdf=function(){if(o.detallePDFRapidaLoading=!0,void 0===o.cuota1||void 0===o.cuota2)alert("Faltan datos"),o.detallePDFRapidaLoading=!1;else{var e=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?A().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro=o.selectedBonificacion.seguro,r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFRapidaLoading=!1})}):j().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(m.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion)).open(),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(g.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFRapidaLoading=!1})})}},o.openAnalistaPdf=function(){if(o.detallePDFAnalistaLoading=!0,void 0===o.cuota1||void 0===o.cuota2)alert("Faltan datos"),o.detallePDFAnalistaLoading=!1;else{var e=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?A().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.gastosvehiculo=o.gastosVehiculo,r.placa=o.placaVehiculo,r.bonificacionSeguro=o.selectedBonificacion.seguro,r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.propietario="",r.asegurado="",r.id_uso=o.usoSeguro,r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfMake.createPdf(d.impresionAnalistaPDF(r,extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1})}):j().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.gastosvehiculo=o.gastosVehiculo,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.propietario="",r.asegurado="",r.id_uso=o.usoSeguro,r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(f.impresionAnalistaLeasingOperativaPDF(r,extrasCotizacion,o.extrasPromocion)).open(),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(h.impresionAnalistaLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1})})}},o.limpiarDatos=function(){o.selectedModelo=null,o.selectedPromocion=null,o.selectedMoneda=null,o.selectedAnnio=null,o.costoConGastos=null,o.gastosVehiculo=null,o.prima=null,o.montoPrima=null,o.libre=0,o.cuota1=null,o.cuota2=null,o.cuota3=null,o.correoRapido=null},o.enviarCorreoRapido=function(){if(o.correoRapidoLoading=!0,void 0===o.cuota1||void 0===o.cuota2)alert("Faltan datos"),o.correoRapidoLoading=!1;else if(void 0===o.correoRapido||null==o.correoRapido)alert("digite correo"),o.correoRapidoLoading=!1;else{var e=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?A().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro=o.selectedBonificacion.seguro,r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDF=e,v(o.correoRapido,o.archivoPDF).then(function(e){alert("Correo enviado"),o.correoRapidoLoading=!1})})})}):j().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(m.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion))),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDF=e,v(o.correoRapido,o.archivoPDF).then(function(e){alert("Correo enviado"),o.correoRapidoLoading=!1})})})})}},o.calcularCuota=function(){if(o.calcularLoading=!0,void 0===o.tipoVehiculoComprar)alert("Debe seleccionar Tipo de vehiculo"),o.calcularLoading=!1;else if(void 0===o.selectedMarca)alert("Debe seleccionar Marca"),o.calcularLoading=!1;else if(void 0===o.selectedModelo)alert("Debe seleccionar Modelo"),o.calcularLoading=!1;else if(void 0===o.selectedPromocion)alert("Debe seleccionar Promociones"),o.calcularLoading=!1;else if(void 0===o.selectedMoneda)alert("Debe seleccionar Moneda"),o.calcularLoading=!1;else if(void 0===o.selectedAnnio)alert("Debe seleccionar AÃ±o"),o.calcularLoading=!1;else if(void 0===o.costoConGastos)alert("Debe ingresar Costo del vehiculo con gastos"),o.calcularLoading=!1;else if(void 0===o.gastosVehiculo)alert("Debe ingresar gastos del vehiculo"),o.calcularLoading=!1;else if(void 0===o.selectedBonificacion)alert("Debe ingresar bonificacion"),o.calcularLoading=!1;else if(void 0===o.deudorTipo)alert("Debe ingresar deudor tipo"),o.calcularLoading=!1;else if(void 0===o.usoSeguro)alert("Debe ingresar uso del seguro"),o.calcularLoading=!1;else if(void 0===o.prima){if(void 0!==o.montoPrima&&null!=o.montoPrima||(alert("Debe ingresar prima del vehiculo o monto de prima"),o.calcularLoading=!1),o.montoPrima>0){var e=c.calcularMontoPrima(o.costoConGastos,o.montoPrima);e<o.seccion.porcentaje?(alert("Monto de prima inferior al % de prima minimo"),o.calcularLoading=!1):(o.prima=parseFloat(e),"0"==o.tipoPrestamo?A().then(function(o){D().then(function(o){b()})}):j().then(function(o){D().then(function(o){b()})}))}}else if(void 0===o.montoPrima)if(void 0===o.prima||null==o.prima)alert("Debe ingresar monto de prima del vehiculo o ingresar % de prima"),o.calcularLoading=!1;else if(o.prima<parseFloat(o.seccion.porcentaje))alert("Debe ingresar % de prima mayor a "+o.seccion.porcentaje),o.calcularLoading=!1;else{var a=c.calcularPrimaMonto(o.costoConGastos,o.prima);o.montoPrima=a,"0"==o.tipoPrestamo?A().then(function(o){D().then(function(o){b()})}):j().then(function(o){D().then(function(o){b()})})}else if(null===o.montoPrima)if(o.prima<o.seccion.porcentaje)alert("% de prima inferior al % de prima minimo"),o.calcularLoading=!1;else{var a=c.calcularPrimaMonto(o.costoConGastos,o.prima);o.montoPrima=a,"0"==o.tipoPrestamo?A().then(function(o){D().then(function(o){b()})}):j().then(function(o){D().then(function(o){b()})})}else{var e=c.calcularMontoPrima(o.costoConGastos,o.montoPrima);parseFloat(e)<parseFloat(o.seccion.porcentaje)?(alert("Monto de prima inferior al % de prima minimo"),o.calcularLoading=!1):(o.prima=parseFloat(e),"0"==o.tipoPrestamo?A().then(function(o){D().then(function(o){b()})}):j().then(function(o){D().then(function(o){b()})}))}},o.onMarcasChange=function(){o.modelosLoading=!0,"CREDIAUTOS"==o.selectedMarca.descripcion||"NOVACIONES"==o.selectedMarca.descripcion||"TERCEROS"==o.selectedMarca.descripcion?o.esUsado=!0:o.esUsado=!1,"ISUZU"==o.selectedMarca.descripcion?o.opcionIsuzu=!0:o.opcionIsuzu=!1,o.modelos=[],o.promociones=[],n.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:o.selectedMarca.descripcion}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,o.modelosLoading=!1}else o.modelos=[],o.modelosLoading=!1}).error(function(o,e){console.log(o)})},o.onTipoPrestamoChange=function(){if("0"==o.tipoPrestamo?o.prendarioTrue=!0:o.prendarioTrue=!1,o.promocionesLoading=!0,o.promociones=[],o.selectedModelo){var e={marca:o.selectedMarca.descripcion,modelo:o.selectedModelo.modelo,id_tipo_prestamo:o.tipoPrestamo};n.post("app/vendedor/php/getPromocionesByMarcaModelo.php",e).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);""!=r[0].activo&&a.push(r[0])}o.promociones=a,o.promocionesLoading=!1}else o.promociones=[],o.promocionesLoading=!1}).error(function(o,e){console.log(o)})}else o.promocionesLoading=!1},o.onModeloChange=function(){if(o.promocionesLoading=!0,o.promociones=[],o.selectedModelo){var e={marca:o.selectedMarca.descripcion,modelo:o.selectedModelo.modelo,id_tipo_prestamo:o.tipoPrestamo};n.post("app/vendedor/php/getPromocionesByMarcaModelo.php",e).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);""!=r[0].activo&&a.push(r[0])}o.promociones=a,o.promocionesLoading=!1}else o.promociones=[],o.promocionesLoading=!1}).error(function(o,e){console.log(o)})}else o.promocionesLoading=!1},o.onPromocionChange=function(){o.cuota1="",o.cuota2="",o.cuota3="",I(),N(),T()},o.agregarCotizacion=function(){if(o.dataLoading=!0,o.resultadoPreAprobacion=0,void 0!=o.cuota1||void 0!=o.cuota2)if(o.cuota2>.33*o.salarioNeto){var e=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?A().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro=o.selectedBonificacion.seguro,r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(u.impresionNoPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,y().then(function(e){R().then(function(e){U(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;G(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){k(),alert("Su salario no es suficiente para cubrir las cuotas, enviado para estudio")})})})})})})})}):j().then(function(a){D().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(m.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion))),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(u.impresionNoPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,y().then(function(e){R().then(function(e){U(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;G(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){k(),alert("Su salario no es suficiente para cubrir las cuotas, enviado para estudio")})})})})})})})})}else P().then(function(e){if(1==e.resultadoPreAprobacion){o.resultadoPreAprobacion=1;var a=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?A().then(function(e){D().then(function(e){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=a,r.placa=o.placaVehiculo,r.bonificacionSeguro=o.selectedBonificacion.seguro,r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(p.impresionPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,y().then(function(e){R().then(function(e){U(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;J(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){k(),alert("Cotizacion enviada")})})})})})})})}):j().then(function(e){D().then(function(e){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=a,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(m.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion))),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(p.impresionPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,y().then(function(e){R().then(function(e){U(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;J(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){k(),alert("Cotizacion enviada")})})})})})})})})}else if(0==e.resultadoPreAprobacion)k(),alert(e.mensajeError);else{var r=e.mensajePreAprobacion,a=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?A().then(function(e){D().then(function(e){var i=o.detallesPDF;i.seguroTotal=-1,i.seguroMensual=-1,i.preciocongastos=o.costoConGastos.toFixed(2),i.costovehiculo=a,i.placa=o.placaVehiculo,i.bonificacionSeguro=o.selectedBonificacion.seguro,i.anno=o.selectedAnnio.anno,i.libre=o.libre,i.prima=o.prima,i.nombre=o.nombre,i.apellido1=o.apellido1,i.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(i,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(u.impresionNoPreAprobacionPDF(i,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,y().then(function(e){R().then(function(e){U(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;G(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){k(),alert(r)})})})})})})})}):j().then(function(e){D().then(function(e){var i=o.detallesPDF;i.seguroTotal=-1,i.seguroMensual=-1,i.preciocongastos=o.costoConGastos.toFixed(2),i.costovehiculo=a,i.placa=o.placaVehiculo,i.bonificacionSeguro="0",i.anno=o.selectedAnnio.anno,i.libre=o.libre,i.prima=o.prima,i.nombre=o.nombre,i.apellido1=o.apellido1,i.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=i.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(m.impresionClienteLeasingOperativoPDF(i,extrasCotizacion,o.extrasPromocion))),-1!=i.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingFinancieroPDF(i,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(u.impresionNoPreAprobacionPDF(i,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,y().then(function(e){R().then(function(e){U(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;G(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){k(),alert(r)})})})})})})})})}});else alert("Es necesario calcular las cuotas"),o.dataLoading=!1}}function ExtrasController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/extras/php/getExtras.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.extras=a,o.dataLoading=!1,o.totalItems=o.extras.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.extras=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/extras/php/deleteExtra.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarExtra=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.extras,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function HomeController(o,e){}function LineaFinancieraController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/lineaFinanciera/php/getLineaFinanciera.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.lineaFinanciera=a,o.dataLoading=!1,o.totalItems=o.lineaFinanciera.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.lineaFinanciera=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/lineaFinanciera/php/deleteLineaFinanciera.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarLineaFinanciera=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.lineaFinanciera,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function LoginController(o,e,a,r,i,n,t,s){function c(){var a=n.defer(),r=a.promise;return i.post("app/login/php/login.php",{username:o.username}).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r);if(o.username===i[0].login_&&o.password===i[0].password_){e.user=i[0];var n=s.encrypt(e.user.login_);t.cookie.set("user",n),a.resolve(i[0])}else o.error="Datos incorrectos",o.dataLoading=!1}else o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error)}).error(function(e,r){o.error="Error de conexion",o.dataLoading=!1,a.reject(e)}),r}o.imgLoading=a.img,t.cookie.isSupported&&console.log("lo soporta"),o.login=function(){o.dataLoading=!0,c().then(function(o){r.path("/home")})}}function MarcasController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/marcas/php/getMarcas.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.marcas=a,o.dataLoading=!1,o.totalItems=o.marcas.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.marcas=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/marcas/php/deleteMarca.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarMarca=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.marcas,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function MonedasController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/monedas/php/getMonedas.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.monedas=a,o.dataLoading=!1,o.totalItems=o.monedas.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.monedas=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/monedas/php/deleteMoneda.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarMoneda=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.monedas,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function PasswordController(o,e,a,r,i,n){function t(){var a=n.defer(),r=a.promise;return i.post("app/password/password.php",{id:e.user.id,password_:o.newPassword}).success(function(o){angular.isObject(o)&&o.jsonSuccess?a.resolve():a.resolve(o)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,e.user&&e.rolesProcesos&&e.rolesMantenimientos||r.path("/home"),o.changePassword=function(){o.dataLoading=!0,e.user.password_==o.currentPassword?(o.errorPassword=!1,o.newPassword==o.confirmPassword?(o.errorConfirmPassword=!1,t().then(function(o){r.path("/home")})):(o.errorConfirmPassword=!0,o.dataLoading=!1)):(o.errorPassword=!0,o.errorConfirmPassword=!1,o.dataLoading=!1)}}function ProductoBancoController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/productoBanco/php/getProductoBanco.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.productoBanco=a,o.dataLoading=!1,o.totalItems=o.productoBanco.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.productoBanco=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/productoBanco/php/deleteProductoBanco.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarProductoBanco=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.productoBanco,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function RolesController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/roles/php/getRoles.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.todosRoles=a,o.dataLoading=!1,o.totalItems=o.todosRoles.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.todosRoles=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/roles/php/deleteRol.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar porque tiene Usuarios o pantallas asociados"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarRol=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.todosRoles,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function PromocionesController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/promociones/php/getPromociones.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.promociones=a,o.dataLoading=!1,o.totalItems=o.promociones.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.promociones=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/promociones/php/deletePromocion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarPromocion=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.changeSearch=function(){switch(option=o.selected,option){case"0":return o.search.id_tipo_prestamo=0
;case"1":return o.search.id_tipo_prestamo=1;default:return o.search.id_tipo_prestamo=""}},o.resetFilters=function(){o.search={},o.selected="2"},o.$watch("search",function(e,a){o.filtered=s(o.promociones,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function SeccionController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/seccion/php/getSeccion.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.seccion=a,o.dataLoading=!1,o.totalItems=o.seccion.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.seccion=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/seccion/php/deleteSeccion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarSeccion=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.seccion,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function SegurosController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/seguros/php/getSeguros.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.seguros=a,o.dataLoading=!1,o.totalItems=o.seguros.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.seguros=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/seguros/php/deleteSeguro.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarSeguro=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.seguros,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function SegurosLeasingController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/segurosLeasing/php/getSegurosLeasing.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.segurosLeasing=a,o.dataLoading=!1,o.totalItems=o.segurosLeasing.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.segurosLeasing=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/segurosLeasing/php/deleteSeguroLeasing.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarSeguroLeasing=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.segurosLeasing,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function SubAplicacionController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/subAplicacion/php/getSubAplicacion.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.subAplicacion=a,o.dataLoading=!1,o.totalItems=o.subAplicacion.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.subAplicacion=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/subAplicacion/php/deleteSubAplicacion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarSubAplicacion=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.subAplicacion,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function UsuariosController(o,e,a,r,n,t,s){function c(){o.dataLoading=!0,n.post("app/usuarios/php/getUsuarios.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.usuarios=a,o.dataLoading=!1,o.totalItems=o.usuarios.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.usuarios=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function l(e){var a=t.defer(),r=a.promise;return n.post("app/usuarios/php/deleteUsuario.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},c(),o.borrarUsuario=function(e){o.dataLoading=!0,l(e).then(function(o){c()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.usuarios,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function VendedorController(o,e,a,r,n,t,s,c,l,d,p,u,g){function m(){var e=t.defer(),a=e.promise,r=o.salarioBruto-o.salarioNeto,i=o.costoConGastos-o.gastosVehiculo,s=0;return s=(o.tipoVehiculoComprar,1),atributos={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",primerNombreCliente:o.nombre,segundoNombreCliente:o.nombre,primerApellidoCliente:o.apellido1,segundoApellidoCliente:o.apellido2,nombreEmpresa:"",tipoIdentificacion:18,numeroIdentificacion:o.cedula,fechaNacimiento:o.fechaNacimiento,segmentoCotizador:1,antiguedadLaboral:o.fechaIngreso,ingresoActual:o.salarioBruto,gastos:r,tipoVehiculo:s,cuotaSolicitada:0,montoSolicitado:c.calcularSaldoFinanciar(o.costoConGastos,o.costoConGastos*(o.prima/100)),precioVehiculo:i},n.post("app/php/soapServicePreAprobarMonto.php",atributos).success(function(a){angular.isObject(a)?e.resolve(a.return):(o.error="No se pudo crear",e.reject(o.error))}).error(function(a,r){o.error="No se pudo crear",e.reject(a)}),a}function f(e,a){var r=t.defer(),i=r.promise,e={email:e,subject:"CORREO DE COTIZACION DE VEHICULO",message:"Cotizacion rapida de vehiculos",data:a};return n.post("app/php/emailRapidoConArchivo.php",e).success(function(e){angular.isObject(e),o.dataLoading=!1,r.resolve()}).error(function(o,e){console.log(o),r.reject(o)}),i}function h(){o.montoLoJackDeCuota=0,"0"==o.tipoPrestamo?P():v()}function P(){var e=[];e.push(o.selectedExtra);var a=o.costoConGastos-o.gastosVehiculo,r=b(o.libre,o.prima),i=o.costoConGastos-parseFloat(r),n=i*(o.detallesPDF.comisionBancaria/100),t=j(o.detallesPDF,e,o.extrasPromocion),s=c.calcularSeguroDeudaTotal(i,o.detallesPDF.factorSeguro);1!=o.deudorTipo&&2!=o.deudorTipo||(s=0);var l=c.calcularSubTotalSeguro(o.detallesPDF.cambio_dolar,o.detallesPDF.cambio_dolar_seguros,e,o.extrasPromocion,o.detallesPDF.nombreMoneda,a,o.detallesPDF.a,o.detallesPDF.b,o.detallesPDF.c,o.detallesPDF.d,o.detallesPDF.f,o.detallesPDF.g,o.detallesPDF.h),d=c.calcularFinanciamientoSeguro(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,l,"-45"),p=c.calcularSeguroVehiculo(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,l,"-45");"Placa - Bus"==o.detallesPDF.nombreTipoVehiculo&&(p=-1*c.PMT(o.detallesPDF.tasa3/100,12,6*p)),o.seguroVehiculo=p;var u=S(t),g=parseFloat(i)+parseFloat(u)+parseFloat(d)+parseFloat(n)+parseFloat(s);o.saldoAFinanciar=g,L(o.detallesPDF),o.calcularLoading=!1}function v(){var e=[];e.push(o.selectedExtra);var a=o.costoConGastos-o.gastosVehiculo,r=b(o.libre,o.prima),n=o.costoConGastos-parseFloat(r),t=n*(o.detallesPDF.comisionBancaria/100),s=j(o.detallesPDF,e,o.extrasPromocion),l=c.calcularSeguroDeudaTotal(n,o.detallesPDF.factorSeguro);1!=o.deudorTipo&&2!=o.deudorTipo||(l=0);var d=c.calcularSubTotalSeguroLeasing(o.detallesPDF.cambio_dolar,o.detallesPDF.cambio_dolar_seguros,e,o.extrasPromocion,o.detallesPDF.nombreMoneda,a,o.detallesPDF.a,o.detallesPDF.b,o.detallesPDF.c,o.detallesPDF.d,o.detallesPDF.f,o.detallesPDF.g,o.detallesPDF.h),p=c.calcularFinanciamientoSeguroLeasing(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,d,"0"),u=c.calcularSeguroVehiculoLeasing(o.detallesPDF.cambio_dolar_seguros,o.detallesPDF.nombreMoneda,d,"0");"Placa - Bus"==o.detallesPDF.nombreTipoVehiculo&&(u=-1*c.PMT(o.detallesPDF.tasa3/100,12,6*u)),o.seguroVehiculo=u;var g=S(s),m=parseFloat(n)+parseFloat(g)+parseFloat(p)+parseFloat(t)+parseFloat(l);for(o.saldoAFinanciar=m,i=0;i<s.length;i++)palabraMayuscula=s[i].descripcion.toUpperCase(),palabraMayuscula.search("LOJACK")>=0&&(o.montoLoJackDeCuota=s[i].cuota);L(o.detallesPDF),o.calcularLoading=!1}function b(e,a){if(0==e)return o.porcentajePrima=a,o.costoConGastos*(a/100);var r=o.costoConGastos*(a/100);return o.porcentajePrima=((parseFloat(r)+parseFloat(e))/o.costoConGastos*100).toFixed(2),o.costoConGastos*(a/100)+parseFloat(e)}function C(){var a=t.defer(),r=a.promise,i={idPromocion:o.selectedPromocion.id,modelo:o.selectedModelo.modelo,tipo_seguro:o.tipoVehiculoComprar,annio:o.selectedAnnio.anno,moneda:o.selectedMoneda.id_moneda,usoSeguro:o.usoSeguro};return n.post("app/vendedor/php/getDetallePDF.php",i).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],o.detallesPDF.id_moneda=o.selectedMoneda.id_moneda,o.detallesPDF.id_tipopersona="0",d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),r}function F(){var a=t.defer(),r=a.promise,i={idPromocion:o.selectedPromocion.id,modelo:o.selectedModelo.modelo,tipo_seguro:o.tipoVehiculoComprar,annio:o.selectedAnnio.anno,moneda:o.selectedMoneda.id_moneda,usoSeguro:o.usoSeguro};return n.post("app/vendedor/php/getDetalleLeasingPDF.php",i).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],o.detallesPDF.id_moneda=o.selectedMoneda.id_moneda,o.detallesPDF.id_tipopersona="0",d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),r}function L(o){o.subsidioSeguro>0&&o.subsidioTasa>0?G(o):o.subsidioSeguro>0&&o.periodosGracia>0||o.periodosGracia>0&&o.subsidioTasa>0||(o.periodosGracia>0?y(o):o.subsidioTasa>0?tabla=w(o):o.subsidioSeguro>0?k(o):tabla=w(o))}function A(){var e=t.defer(),a=e.promise;return o.extrasPromocion=[],o.selectedPromocion?n.post("app/promociones/agregarDetalle/php/getExtrasByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasPromocion=r,e.resolve()}else o.extrasPromocion=[],e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):e.resolve(),a}function j(o,e,a){var r=[];if(0==e.length&&0==a.length){var n={descripcion:"Sin extras",monto:0,cuota:0};r.push(n)}else{if(e.length>0)for(i=0;i<e.length;i++){var n={};n.descripcion=e[i].descripcion,n.monto=z(o,e[i]),n.cuota=D(o,e[i]),r.push(n)}if(a.length>0)for(i=0;i<a.length;i++){var n={};n.descripcion=a[i].descripcion,n.monto=z(o,a[i]),n.cuota=D(o,a[i]),r.push(n)}}return r}function z(o,e){var a;return 1==o.id_moneda&&1==e.moneda&&(a=e.monto),2==o.id_moneda&&2==e.moneda&&(a=e.monto),1==o.id_moneda&&2==e.moneda&&(a=e.monto/o.cambio_dolar),2==o.id_moneda&&1==e.moneda&&(a=e.monto*o.cambio_dolar),parseFloat(a)}function D(o,e){var a;return 1==o.id_moneda&&1==e.moneda&&(a=e.cuota),2==o.id_moneda&&2==e.moneda&&(a=e.cuota),1==o.id_moneda&&2==e.moneda&&(a=e.cuota/o.cambio_dolar),2==o.id_moneda&&1==e.moneda&&(a=e.cuota*o.cambio_dolar),parseFloat(a)}function S(o){var e=0;for(i=0;i<o.length;i++)e+=o[i].monto;return parseFloat(e)}function M(){O()}function O(){o.marcasLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/marcas/php/getMarcas.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.marcas=r,o.marcasLoading=!1,e.resolve()}else o.marcas=[],o.marcasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function _(){o.plazosPromocion=[],o.plazosPromocion.push(o.seccion.plazo1),o.plazosPromocion.push(o.seccion.plazo1-12),o.plazosPromocion.push(o.seccion.plazo1-24),o.plazosPromocion.push(o.seccion.plazo1-36),o.selectedPlazo=o.plazosPromocion[0]}function $(){o.selectedPromocion&&n.post("app/vendedor/php/getSeccionByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(e){if(angular.isObject(e)){var a={};for(i=0;i<e.length;i++){a=JSON.parse(e[i])[0]}o.seccion=a,o.prima=parseFloat(a.porcentaje),_()}else o.seccion={}}).error(function(o,e){console.log(o)})}function x(){o.monedasLoading=!0,o.monedas=[],o.selectedPromocion?n.post("app/vendedor/php/getMonedasByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.monedas=a,o.selectedMoneda=o.monedas[0],o.monedasLoading=!1}else o.monedas=[],o.monedasLoading=!1}).error(function(o,e){console.log(o)}):o.monedasLoading=!1}function E(){o.anniosLoading=!0,o.annios=[],o.selectedPromocion?n.post("app/vendedor/php/getAnniosByPromocion.php",{idPromocion:o.selectedPromocion.id}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.annios=a,o.selectedAnnio=o.annios[0],o.anniosLoading=!1}else o.annios=[],o.anniosLoading=!1}).error(function(o,e){console.log(o)}):o.anniosLoading=!1}function T(){I()}function I(){o.marcasLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/vendedor/php/getMarcasByUsuario.php",{idUsuario:o.user.id}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0]),palabraMayuscula=n[0].descripcion.toUpperCase().trim(),palabraMayuscula.search("CREDIAUTOS")>=0||palabraMayuscula.search("NOVACIONES")>=0||palabraMayuscula.search("TERCEROS")>=0?(o.tipoVehiculoComprar="2",o.disableTipoVehiculoComprar=!0):(o.tipoVehiculoComprar="1",o.disableTipoVehiculoComprar=!0)}o.marcas=r,o.selectedMarca=o.marcas[0],o.onMarcasChange(),o.marcasLoading=!1,e.resolve()}else o.marcas=[],o.marcasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function N(){var e=t.defer(),a=e.promise,r={id_bandeja:o.idCotizacion,id_extra:o.selectedExtra.id};return n.post("app/vendedor/php/agregarExtraBandeja.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}function B(e){var a=t.defer(),r=a.promise,i=(o.costoConGastos,o.gastosVehiculo,{id_bandeja:e,id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2});return n.post("app/vendedor/php/agregarSolicitud.php",i).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}function V(e,a,r,i,c,l){var d=t.defer(),p=d.promise,u=s.mensaje(e,a,r,i),i={email:i,subject:"CORREO DE PREAPROBACION DE VEHICULO",message:u,data:c,cartaPreAprobacion:l};return n.post("app/php/enviarEmailPreAprobacion.php",i).success(function(e){angular.isObject(e),o.dataLoading=!1,d.resolve()}).error(function(o,e){console.log(o),d.reject(o)}),p}function R(e,a,r,i,c,l){var d=t.defer(),p=d.promise,u=s.mensaje(e,a,r,i),i={email:i,subject:"CORREO DE PREAPROBACION DE VEHICULO",message:u,data:c,cartaNoPreAprobacion:l};return n.post("app/php/enviarEmailNoPreAprobacion.php",i).success(function(e){angular.isObject(e),o.dataLoading=!1,d.resolve()}).error(function(o,e){console.log(o),d.reject(o)}),p}function U(){o.cedula=null,o.nombre=null,o.apellido1=null,o.apellido2=null,o.correo=null,o.telefono=null,o.salarioBruto=null,o.salarioNeto=null,o.gastos=null,o.prima=null,o.montoPrima=null,o.cuota1=null,o.cuota2=null,o.idCotizacion=null,o.seccion={},o.fechaNacimiento=null,o.fechaIngreso=null,o.cuota3=null,o.gastosVehiculo=null,o.costoConGastos=null,o.placaVehiculo=null,o.selectedPromocion=null,o.form.$setPristine()}function J(){var e=t.defer(),a=e.promise,r="?";"CREDIAUTOS"!=o.selectedMarca.descripcion&&"NOVACIONES"!=o.selectedMarca.descripcion&&"TERCEROS"!=o.selectedMarca.descripcion||(r=o.placaVehiculo);var i=o.salarioBruto-o.salarioNeto,s=o.costoConGastos-o.gastosVehiculo,c={agencia:o.selectedAgencia.id,id_tipo_prestamo:parseFloat(o.tipoPrestamo),id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,fecha_nacimiento:o.fechaNacimiento,antiguedad_laboral:o.fechaIngreso,email:o.correo,telefono:o.telefono,id_estado:o.resultadoPreAprobacion,anno:o.selectedAnnio.anno,ingresobruto:o.salarioBruto,ingreso:o.salarioNeto,gastos:i,tipo_vehiculo_a_comprar:o.tipoVehiculoComprar,costovehiculo:s,preciocongastos:o.costoConGastos,gastosvehiculo:o.gastosVehiculo,prima:o.prima,libre:o.montoPrima,plazo:o.selectedPlazo,id_promocion:o.selectedPromocion.id,id_marca:o.selectedMarca.id,id_marca_modelo:o.selectedModelo.modelo,placa:r,id_usuario:o.user.id};return n.post("app/vendedor/php/agregarCotizacion.php",c).success(function(a){angular.isObject(a)&&a.jsonSuccess?(o.idCotizacion=a.last_id,e.resolve()):(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}function G(e){if(12==parseFloat(e.subsidioSeguro)){plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodoSubsidioSeguro(o.saldoAFinanciar,e.tasa1,parseFloat(plazo1),strPMT1,parseFloat(e.subsidioSeguro))),strPMT3=-1*c.PMT(i,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa2,plazo2Diferencia,strPMT2)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+0).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2)}else{plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar);var n=12-(parseFloat(plazo1)+parseFloat(e.subsidioSeguro));strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodoSubsidioSeguro(o.saldoAFinanciar,e.tasa1,parseFloat(plazo1)+parseFloat(e.subsidioSeguro)+n,strPMT1,parseFloat(e.subsidioSeguro))),strPMT3=-1*c.PMT(i,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa2,plazo2Diferencia+parseFloat(e.subsidioSeguro),strPMT2)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+0).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}}function k(e){plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodoSubsidioSeguro(o.saldoAFinanciar,e.tasa1,parseFloat(plazo1)+parseFloat(e.subsidioSeguro),strPMT1,parseFloat(e.subsidioSeguro))),strPMT3=-1*c.PMT(i,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa2,plazo2Diferencia+parseFloat(e.subsidioSeguro),strPMT2)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+0).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}function y(e){plazo1=e.plazo1-e.plazo2,plazo2Diferencia=e.plazo2-e.plazo3,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3-1,plazoFinal1=plazoFinal+1;var a=o.saldoAFinanciar*(parseFloat(e.tasa2)/100)/12*parseFloat(e.periodosGracia);o.saldoAFinanciar=o.saldoAFinanciar+a;var r=c.calcularTasa(e.tasa1),i=c.calcularTasa(e.tasa2),n=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(r,e.plazo1,o.saldoAFinanciar),cuotaPorPeriodoGracia=0,strPMT2=-1*c.PMT(i,e.plazo2,o.saldoAFinanciar),strPMT3=-1*c.PMT(n,e.plazo3,c.calculaPagoPeriodoDeGracia(o.saldoAFinanciar,e.tasa2,parseFloat(plazo2Diferencia)+parseFloat(e.periodosGracia),strPMT2,parseFloat(plazo2Diferencia))),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}function w(o){o.tasa2==o.tasa3&&H(o),o.tasa1==o.tasa2&&W(o),o.tasa1==o.tasa2&&o.tasa1==o.tasa3&&o.tasa2==o.tasa3&&(tabla=q(o)),o.tasa1!=o.tasa2&&o.tasa2!=o.tasa3&&Z(o)}function q(e){var a=c.calcularTasa(e.tasa1);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,o.cuota2=null,o.cuota3=null}function H(e){plazo1=e.plazo1-e.plazo2,plazoRestante=plazo1+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa1,plazo1,strPMT1)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2}function W(e){plazo1=e.plazo1-e.plazo3,plazoRestante=plazo1+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo3,c.calculaPagoPeriodo(o.saldoAFinanciar,e.tasa1,plazo1,strPMT1)),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2}function Z(e){plazo1=e.plazo1-e.plazo2,plazo2=plazo1+1,plazo3=e.plazo2-e.plazo3,plazoFinal=plazo2+plazo3,plazoFinal1=plazoFinal+1;var a=c.calcularTasa(e.tasa1),r=c.calcularTasa(e.tasa2),i=c.calcularTasa(e.tasa3);strPMT1=-1*c.PMT(a,e.plazo1,o.saldoAFinanciar),strPMT2=-1*c.PMT(r,e.plazo2,o.saldoAFinanciar),strPMT3=-1*c.PMT(i,e.plazo3,o.saldoAFinanciar),seguroDeudaPrimerAnnio=c.calcularSeguroDeudaPrimerAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaOtroAnnio=c.calcularSeguroDeudaOtroAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),seguroDeudaUltimoAnnio=c.calcularSeguroDeudaUltimoAnnio(o.saldoAFinanciar,o.porcentajePrima,e.factorSeguro),1!=o.deudorTipo&&2!=o.deudorTipo||(seguroDeudaPrimerAnnio=0,seguroDeudaOtroAnnio=0,seguroDeudaUltimoAnnio=0),cuotaFinal1=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT1)+parseFloat(seguroDeudaPrimerAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota1=cuotaFinal1,cuotaFinal2=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT2)+parseFloat(seguroDeudaOtroAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota2=cuotaFinal2,cuotaFinal3=(parseFloat(o.montoLoJackDeCuota)+parseFloat(strPMT3)+parseFloat(seguroDeudaUltimoAnnio)+parseFloat(o.seguroVehiculo)).toFixed(2),o.cuota3=cuotaFinal3}o.imgLoading=a.img,o.seccion={},o.esUsado=!1,o.libre=0,o.usoSeguro="0",o.tipoPrestamo="0",o.disableTipoVehiculoComprar=!1,e.user&&e.rolesProcesos&&e.rolesMantenimientos?(function(){o.agenciasLoading=!0;var a=t.defer(),r=a.promise;n.post("app/usuarios/editarUsuario/php/getAgenciasByUsuario.php",{idUsuario:e.user.id}).success(function(e){if(angular.isObject(e)){var r=[];for(i=0;i<e.length;i++){var n=JSON.parse(e[i]);r.push(n[0])}o.agencias=r,o.selectedAgencia=o.agencias[0],o.agenciasLoading=!1,a.resolve()}else o.agencias=[],o.agenciasLoading=!1,a.reject()}).error(function(o,e){console.log(o),a.reject(o)})}(),function(){e.user&&e.rolesProcesos&&e.rolesMantenimientos?1==e.rolesProcesos[0].admin||1==e.rolesMantenimientos[0].admin?M():T():r.path("/home")}(),function(){n.post("app/vendedor/php/getLoJack.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.extras=a,o.selectedExtra=o.extras[0]}else o.extras=[]}).error(function(o,e){console.log(o)})}()):r.path("/home"),o.consultarCedula=function(){o.consultarCedulaLoading=!0,persona={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",numeroIdentificacion:o.cedula},n.post("app/php/soapServiceValidarIdentificacion.php",persona).success(function(e){angular.isObject(e)&&"EMPTY"!=e.return.resultado?(o.nombre=e.return.nombres.trim(),o.apellido1=e.return.apellido1.trim(),o.apellido2=e.return.apellido2.trim(),o.consultarCedulaLoading=!1):(o.error="No existe",alert("La cedula no existe"),o.consultarCedulaLoading=!1)}).error(function(e,a){alert("No se pudo consultar"),o.consultarCedulaLoading=!1})},o.consultarIsuzu=function(){o.mensajeIsuzu="",o.cedulaIsuzuLoading=!0,atributos={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",numeroIdentificacion:o.cedula},n.post("app/php/soapServicePreaprobarCedula.php",atributos).success(function(e){"0"==e.return?o.mensajeIsuzu="No presenta anotaciones negativas":"3"==e.return?o.mensajeIsuzu="Cedula no registrada":o.mensajeIsuzu="Presenta anotaciones negativas",o.cedulaIsuzuLoading=!1}).error(function(e,a){o.error="No se pudo consultar",o.cedulaIsuzuLoading=!1})},o.openRapidaPdf=function(){if(o.detallePDFRapidaLoading=!0,void 0===o.cuota1||void 0===o.cuota2)alert("Faltan datos"),o.detallePDFRapidaLoading=!1;else{var e=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?C().then(function(a){A().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="-45",r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFRapidaLoading=!1})}):F().then(function(a){A().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(g.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion)).open(),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(u.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFRapidaLoading=!1})})}},o.limpiarDatos=function(){o.selectedModelo=null,o.selectedPromocion=null,o.selectedMoneda=null,o.selectedAnnio=null,o.costoConGastos=null,o.gastosVehiculo=null,o.prima=null,o.montoPrima=null,o.libre=0,o.cuota1=null,o.cuota2=null,o.cuota3=null,o.correoRapido=null},o.enviarCorreoRapido=function(){if(o.correoRapidoLoading=!0,void 0===o.cuota1||void 0===o.cuota2)alert("Faltan datos"),
o.correoRapidoLoading=!1;else if(void 0===o.correoRapido||null==o.correoRapido)alert("digite correo"),o.correoRapidoLoading=!1;else{var e=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?C().then(function(a){A().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="-45",r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDF=e,f(o.correoRapido,o.archivoPDF).then(function(e){alert("Correo enviado"),o.correoRapidoLoading=!1})})})}):C().then(function(a){A().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima.toString(),r.nombre="",r.apellido1="",r.apellido2="",r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion))),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(u.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDF=e,f(o.correoRapido,o.archivoPDF).then(function(e){alert("Correo enviado"),o.correoRapidoLoading=!1})})})})}},o.calcularCuota=function(){if(o.calcularLoading=!0,void 0===o.tipoVehiculoComprar)alert("Debe seleccionar Tipo de vehiculo"),o.calcularLoading=!1;else if(void 0===o.selectedMarca)alert("Debe seleccionar Marca"),o.calcularLoading=!1;else if(void 0===o.selectedModelo)alert("Debe seleccionar Modelo"),o.calcularLoading=!1;else if(void 0===o.selectedPromocion)alert("Debe seleccionar Promociones"),o.calcularLoading=!1;else if(void 0===o.selectedMoneda)alert("Debe seleccionar Moneda"),o.calcularLoading=!1;else if(void 0===o.selectedAnnio)alert("Debe seleccionar AÃ±o"),o.calcularLoading=!1;else if(void 0===o.costoConGastos)alert("Debe ingresar Costo del vehiculo con gastos"),o.calcularLoading=!1;else if(void 0===o.gastosVehiculo)alert("Debe ingresar gastos del vehiculo"),o.calcularLoading=!1;else if(void 0===o.prima){if(void 0!==o.montoPrima&&null!=o.montoPrima||(alert("Debe ingresar prima del vehiculo o monto de prima"),o.calcularLoading=!1),o.montoPrima>0){var e=c.calcularMontoPrima(o.costoConGastos,o.montoPrima);e<o.seccion.porcentaje?(alert("Monto de prima inferior al % de prima minimo"),o.calcularLoading=!1):(o.prima=parseFloat(e),"0"==o.tipoPrestamo?C().then(function(o){A().then(function(o){h()})}):F().then(function(o){A().then(function(o){h()})}))}}else if(void 0===o.montoPrima)if(void 0===o.prima||null==o.prima)alert("Debe ingresar monto de prima del vehiculo o ingresar % de prima"),o.calcularLoading=!1;else if(o.prima<parseFloat(o.seccion.porcentaje))alert("Debe ingresar % de prima mayor a "+o.seccion.porcentaje),o.calcularLoading=!1;else{var a=c.calcularPrimaMonto(o.costoConGastos,o.prima);o.montoPrima=a,"0"==o.tipoPrestamo?C().then(function(o){A().then(function(o){h()})}):F().then(function(o){A().then(function(o){h()})})}else if(null===o.montoPrima)if(o.prima<o.seccion.porcentaje)alert("% de prima inferior al % de prima minimo"),o.calcularLoading=!1;else{var a=c.calcularPrimaMonto(o.costoConGastos,o.prima);o.montoPrima=a,"0"==o.tipoPrestamo?C().then(function(o){A().then(function(o){h()})}):F().then(function(o){A().then(function(o){h()})})}else{var e=c.calcularMontoPrima(o.costoConGastos,o.montoPrima);parseFloat(e)<parseFloat(o.seccion.porcentaje)?(alert("Monto de prima inferior al % de prima minimo"),o.calcularLoading=!1):(o.prima=parseFloat(e),"0"==o.tipoPrestamo?C().then(function(o){A().then(function(o){h()})}):F().then(function(o){A().then(function(o){h()})}))}},o.onMarcasChange=function(){o.modelosLoading=!0,"CREDIAUTOS"==o.selectedMarca.descripcion||"NOVACIONES"==o.selectedMarca.descripcion||"TERCEROS"==o.selectedMarca.descripcion?o.esUsado=!0:o.esUsado=!1,"ISUZU"==o.selectedMarca.descripcion?o.opcionIsuzu=!0:o.opcionIsuzu=!1,o.modelos=[],o.promociones=[],n.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:o.selectedMarca.descripcion}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,o.modelosLoading=!1}else o.modelos=[],o.modelosLoading=!1}).error(function(o,e){console.log(o)})},o.onTipoPrestamoChange=function(){if(o.promocionesLoading=!0,o.promociones=[],o.selectedModelo){var e={marca:o.selectedMarca.descripcion,modelo:o.selectedModelo.modelo,id_tipo_prestamo:o.tipoPrestamo};n.post("app/vendedor/php/getPromocionesByMarcaModelo.php",e).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);""!=r[0].activo&&a.push(r[0])}o.promociones=a,o.promocionesLoading=!1}else o.promociones=[],o.promocionesLoading=!1}).error(function(o,e){console.log(o)})}else o.promocionesLoading=!1},o.onModeloChange=function(){if(o.promocionesLoading=!0,o.promociones=[],o.selectedModelo){var e={marca:o.selectedMarca.descripcion,modelo:o.selectedModelo.modelo,id_tipo_prestamo:o.tipoPrestamo};n.post("app/vendedor/php/getPromocionesByMarcaModelo.php",e).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);""!=r[0].activo&&a.push(r[0])}o.promociones=a,o.promocionesLoading=!1}else o.promociones=[],o.promocionesLoading=!1}).error(function(o,e){console.log(o)})}else o.promocionesLoading=!1},o.onPromocionChange=function(){o.cuota1="",o.cuota2="",o.cuota3="",x(),E(),$()},o.agregarCotizacion=function(){if(o.dataLoading=!0,o.resultadoPreAprobacion=0,void 0!=o.cuota1||void 0!=o.cuota2)if(o.cuota2>.33*o.salarioNeto){var e=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?C().then(function(a){A().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="-45",r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(p.impresionNoPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,J().then(function(e){N().then(function(e){B(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;R(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){U(),alert("Su salario no es suficiente para cubrir las cuotas, enviado para estudio")})})})})})})})}):F().then(function(a){A().then(function(a){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=e,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.montoPrima,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion))),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(u.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(p.impresionNoPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,J().then(function(e){N().then(function(e){B(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;R(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){U(),alert("Su salario no es suficiente para cubrir las cuotas, enviado para estudio")})})})})})})})})}else m().then(function(e){if(1==e.resultadoPreAprobacion){o.resultadoPreAprobacion=1;var a=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?C().then(function(e){A().then(function(e){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=a,r.placa=o.placaVehiculo,r.bonificacionSeguro="-45",r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(d.impresionPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,J().then(function(e){N().then(function(e){B(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;V(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){U(),alert("Cotizacion enviada")})})})})})})})}):F().then(function(e){A().then(function(e){var r=o.detallesPDF;r.seguroTotal=-1,r.seguroMensual=-1,r.preciocongastos=o.costoConGastos.toFixed(2),r.costovehiculo=a,r.placa=o.placaVehiculo,r.bonificacionSeguro="0",r.anno=o.selectedAnnio.anno,r.libre=o.libre,r.prima=o.prima,r.nombre=o.nombre,r.apellido1=o.apellido1,r.apellido2=o.apellido2,r.id_moneda=o.selectedMoneda.id_moneda,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=r.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingOperativoPDF(r,extrasCotizacion,o.extrasPromocion))),-1!=r.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(u.impresionClienteLeasingFinancieroPDF(r,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(d.impresionPreAprobacionPDF(r,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,J().then(function(e){N().then(function(e){B(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;V(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){U(),alert("Cotizacion enviada")})})})})})})})})}else if(0==e.resultadoPreAprobacion)U(),alert(e.mensajeError);else{var r=e.mensajePreAprobacion,a=o.costoConGastos-o.gastosVehiculo;"0"==o.tipoPrestamo?C().then(function(e){A().then(function(e){var i=o.detallesPDF;i.seguroTotal=-1,i.seguroMensual=-1,i.preciocongastos=o.costoConGastos.toFixed(2),i.costovehiculo=a,i.placa=o.placaVehiculo,i.bonificacionSeguro="-45",i.anno=o.selectedAnnio.anno,i.libre=o.libre,i.prima=o.prima,i.nombre=o.nombre,i.apellido1=o.apellido1,i.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),pdfDocGenerator=pdfMake.createPdf(l.impresionClientePDF(i,extrasCotizacion,o.extrasPromocion)),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(p.impresionNoPreAprobacionPDF(i,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,J().then(function(e){N().then(function(e){B(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;R(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){U(),alert(r)})})})})})})})}):F().then(function(e){A().then(function(e){var i=o.detallesPDF;i.seguroTotal=-1,i.seguroMensual=-1,i.preciocongastos=o.costoConGastos.toFixed(2),i.costovehiculo=a,i.placa=o.placaVehiculo,i.bonificacionSeguro="0",i.anno=o.selectedAnnio.anno,i.libre=o.libre,i.prima=o.prima,i.nombre=o.nombre,i.apellido1=o.apellido1,i.apellido2=o.apellido2,extrasCotizacion=[],extrasCotizacion.push(o.selectedExtra),-1!=i.nombrePromocion.toUpperCase().search("OPERATIVO")&&(pdfDocGenerator=pdfMake.createPdf(g.impresionClienteLeasingOperativoPDF(i,extrasCotizacion,o.extrasPromocion))),-1!=i.nombrePromocion.toUpperCase().search("FINANCIERO")&&(pdfDocGenerator=pdfMake.createPdf(u.impresionClienteLeasingFinancieroPDF(i,extrasCotizacion,o.extrasPromocion))),pdfDocGenerator.getBase64(function(e){o.archivoPDFCotizacion=e,pdfDocPreAprobacion=pdfMake.createPdf(p.impresionNoPreAprobacionPDF(i,extrasCotizacion,o.extrasPromocion)),pdfDocPreAprobacion.getBase64(function(e){o.archivoPDFPreAprobacion=e,J().then(function(e){N().then(function(e){B(o.idCotizacion).then(function(e){var a=o.nombre+" "+o.apellido1+" "+o.apellido2;R(o.idCotizacion,a,o.cedula,o.correo,o.archivoPDFCotizacion,o.archivoPDFPreAprobacion).then(function(o){U(),alert(r)})})})})})})})})}});else alert("Es necesario calcular las cuotas"),o.dataLoading=!1}}function VariablesController(o,e,a,r,n,t,s,c){o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},function(){o.dataLoading=!0,n.post("app/variables/php/getVariables.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.variables=a,o.dataLoading=!1,o.totalItems=o.variables.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.variables=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.variables,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarAgenciaController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/agencias/agregarAgencia/agregarAgencia.php",{nombre:o.nombre}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarAgencia=function(){o.dataLoading=!0,t().then(function(o){r.path("/agencias")})}}function EditarAgenciaController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/agencias/editarAgencia/php/editarAgencia.php",{id:o.id,nombre:o.nombre}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/agencias/editarAgencia/php/getAgenciaById.php",{idAgencia:t.idAgencia}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.agencia=a[0],o.id=a[0].id,o.nombre=a[0].nombre,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarAgencia=function(){o.dataLoading=!0,s().then(function(o){r.path("/agencias")})}}function AgregarAnnioController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/annios/agregarAnnio/agregarAnnio.php",{annio:o.annio}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarAnnio=function(){o.dataLoading=!0,t().then(function(o){r.path("/annos")})}}function EditarAnnioController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/annios/editarAnnio/php/editarAnnio.php",{id:o.id,valor:o.valorAnnio}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){i.post("app/annios/editarAnnio/php/getAnnioById.php",{idAnnio:t.idAnnio}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.annio=a[0],o.id=a[0].id,o.valorAnnio=a[0].valor}else console.log("sin datos")}).error(function(o,e){console.log(o)})}(),o.editarAnnio=function(){o.dataLoading=!0,s().then(function(o){r.path("/annos")})}}function DetalleAdministradorController(o,e,a,r,n,t,s,c,l,d,p,u,g,m,f){function h(){var e=t.defer(),a=e.promise,i=o.salarioBruto-o.salarioNeto;o.gastos=i;var n=o.precioConGastos-o.gastosDelVehiculo;return o.precioSinGastos=n,atributos={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",primerNombreCliente:o.nombre,segundoNombreCliente:o.nombre,primerApellidoCliente:o.apellido1,segundoApellidoCliente:o.apellido2,nombreEmpresa:"",tipoIdentificacion:18,numeroIdentificacion:o.cedula,fechaNacimiento:o.fechaNacimiento,segmentoCotizador:1,antiguedadLaboral:o.fechaIngreso,ingresoActual:o.salarioBruto,gastos:i,tipoVehiculo:o.vehiculo,cuotaSolicitada:0,montoSolicitado:s.calcularSaldoFinanciar(o.precioConGastos,o.precioConGastos*(o.prima/100)),precioVehiculo:n},r.post("app/php/soapServicePreAprobarMonto.php",atributos).success(function(a){console.log(a),angular.isObject(a)?e.resolve(a.return):(o.error="No se pudo crear",e.reject(o.error))}).error(function(a,r){o.error="No se pudo crear",e.reject(a)}),a}function P(){var e=t.defer(),a=e.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/borrarExtras.php",{idBandeja:n.idCaso}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(alert("No se puede eliminar"),o.guardarLoading=!1,e.reject())}).error(function(o,a){console.log(o),e.reject(o)}),a}function v(){var e=t.defer(),a=e.promise;if(o.extrasCotizacion.length>0)for(i=0;i<o.extrasCotizacion.length;i++){var s={id_bandeja:n.idCaso,id_extra:o.extrasCotizacion[i].id};r.post("app/bandejaEntrada/detalleCotizacion/php/agregarExtrasBandeja.php",s).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.guardarLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.guardarLoading=!1,console.log(a),e.reject(a)})}else e.resolve();return a}function b(){var e=t.defer(),a=e.promise,i={idCaso:n.idCaso,id_estado:o.id_estado,tipo_vehiculo_a_comprar:o.vehiculo,id_marca_modelo:o.selectedModelo.modelo,anno:o.selectedAnnio.anno,ingresobruto:o.salarioBruto,ingreso:o.salarioNeto,gastos:o.gastos,costovehiculo:o.precioSinGastos,id_bonificacion:o.selectedBonificacion.id,id_moneda:o.selectedMoneda.id_moneda,vehiculoParaInscribir:o.vehiculoParaInscribir,id_firmaexterna:o.firmaExterna,gastosvehiculo:o.gastosDelVehiculo,preciocongastos:o.precioConGastos,prima:o.prima,plazo:o.selectedPlazo,libre:o.montoPrima,id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,fecha_nacimiento:o.fechaNacimiento,antiguedad_laboral:o.fechaIngreso,email:o.correo,id_tipopersona:o.deudorTipo,telefono:o.telefono,propietario:o.propietario,id_tipopersonainscribe:o.inscripcion,asegurado:o.asegurado,id_uso:o.usoSeguro,id_promocion:o.selectedPromocion.idPromocion};return r.post("app/bandejaEntrada/detalleCotizacion/php/editarDetalles.php",i).success(function(a){angular.isObject(a)&&a.jsonSuccess?(o.guardarLoading=!1,e.resolve()):(o.guardarLoading=!1,e.resolve(a))}).error(function(o,a){console.log(o),e.reject(o)}),a}function C(){if(void 0===o.prima){if(void 0===o.montoPrima||o.montoPrima,o.montoPrima>0){var e=s.calcularMontoPrima(o.precioConGastos,o.montoPrima);o.prima=e}}else if(void 0===o.montoPrima)if(void 0===o.prima||null==o.prima)alert("Debe ingresar monto de prima del vehiculo o ingresar % de prima"),o.calcularLoading=!1;else{var a=s.calcularPrimaMonto(o.precioConGastos,o.prima);o.montoPrima=a}else if(null===o.montoPrima){var a=s.calcularPrimaMonto(o.precioConGastos,o.prima);o.montoPrima=a}else{var e=s.calcularMontoPrima(o.precioConGastos,o.montoPrima);o.prima=parseFloat(e)}}function F(){o.modelosLoading=!0,r.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:o.detalle.nombreMarca}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,L(),o.modelosLoading=!1}else o.modelos=[],o.modelosLoading=!1}).error(function(o,e){console.log(o)})}function L(){for(i=0;i<o.modelos.length;i++)o.modelos[i].modelo.trim()==o.detalle.id_marca_modelo.trim()&&(o.selectedModelo=o.modelos[i])}function A(){var e=t.defer(),a=e.promise;o.promocionesLoading=!0,o.promociones=[];var n={marca:o.nombreMarca,modelo:o.modelo,id_tipo_prestamo:o.tipoPrestamo};return r.post("app/bandejaEntrada/detalleCotizacion/php/getPromocionesByMarcaModelo.php",n).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);""!=n[0].descripcion&&r.push(n[0])}o.promociones=r,o.promocionesLoading=!1,x(o.detalle.id_promocion),e.resolve()}else o.promociones=[],o.promocionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function j(){o.plazosPromocion=[],o.plazosPromocion.push(o.selectedPromocion.plazo1),o.plazosPromocion.push(o.selectedPromocion.plazo1-12),o.plazosPromocion.push(o.selectedPromocion.plazo1-24),o.plazosPromocion.push(o.selectedPromocion.plazo1-36),o.selectedPlazo=o.plazosPromocion[0]}function z(){o.plazosPromocion=[],o.plazosPromocion.push((parseFloat(o.selectedPromocion.plazo1)+84).toString()),o.plazosPromocion.push((parseFloat(o.selectedPromocion.plazo1)+72).toString()),o.plazosPromocion.push((parseFloat(o.selectedPromocion.plazo1)+60).toString()),o.plazosPromocion.push((parseFloat(o.selectedPromocion.plazo1)+48).toString()),o.plazosPromocion.push((parseFloat(o.selectedPromocion.plazo1)+36).toString()),o.plazosPromocion.push((parseFloat(o.selectedPromocion.plazo1)+24).toString()),o.plazosPromocion.push((parseFloat(o.selectedPromocion.plazo1)+12).toString()),o.plazosPromocion.push(o.selectedPromocion.plazo1),o.plazosPromocion.push((o.selectedPromocion.plazo1-12).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-24).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-36).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-48).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-60).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-72).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-84).toString()),o.selectedPlazo=o.plazo}function D(){var e=t.defer(),a=e.promise;return o.anniosLoading=!0,o.annios=[],o.selectedPromocion?r.post("app/vendedor/php/getAnniosByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.annios=r,T(o.detalle.anno),o.anniosLoading=!1,e.resolve()}else o.annios=[],o.anniosLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.anniosLoading=!1,e.resolve()),a}function S(){var e=t.defer(),a=e.promise;return o.monedasLoading=!0,o.monedas=[],o.selectedPromocion?r.post("app/vendedor/php/getMonedasByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.monedas=r,I(),o.monedasLoading=!1,e.resolve()}else o.monedas=[],o.monedasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.monedasLoading=!1,e.resolve()),a}function M(){var e=t.defer(),a=e.promise;return o.bonificacionesLoading=!0,o.bonificaciones=[],o.selectedPromocion?r.post("app/bonificaciones/php/getBonificaciones.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.bonificaciones=r,N(o.detalle.id_bonificacion),o.bonificacionesLoading=!1,e.resolve()}else o.bonificaciones=[],o.bonificacionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.bonificacionesLoading=!1,e.resolve()),a}function O(){var e=t.defer(),a=e.promise;return o.extrasLoading=!0,o.extras=[],o.selectedPromocion?r.post("app/extras/php/getExtras.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extras=r,B(o.detalle.id_tecnologico),o.extrasLoading=!1,e.resolve()}else o.extras=[],o.extrasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.extrasLoading=!1,e.resolve()),a}function _(){var e=t.defer(),a=e.promise;return o.extrasPromocionLoading=!0,o.extrasPromocion=[],o.selectedPromocion?r.post("app/promociones/agregarDetalle/php/getExtrasByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasPromocion=r,o.extrasPromocionLoading=!1,e.resolve()}else o.extrasPromocion=[],o.extrasPromocionLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.extrasPromocionLoading=!1,e.resolve()),a}function $(){var e=t.defer(),a=e.promise;return o.badejaLoading=!0,r.post("app/bandejaEntrada/detalleCotizacion/php/getDetalleCotizacion.php",{idCaso:n.idCaso}).success(function(a){if(angular.isObject(a)){var r=JSON.parse(a);o.detalle=r[0],o.id=r[0].id,o.tipoPrestamo=r[0].id_tipo_prestamo,o.id_estado=r[0].id_estado,o.vehiculo=r[0].tipo_vehiculo_a_comprar,o.nombreMarca=r[0].nombreMarca,o.modelo=r[0].id_marca_modelo,F(),o.placaVehiculo=r[0].placa,o.salarioBruto=r[0].ingresobruto,o.salarioNeto=r[0].ingreso,o.gastos=r[0].gastos,o.precioSinGastos=r[0].costovehiculo,o.gastosDelVehiculo=r[0].gastosvehiculo,o.precioConGastos=r[0].preciocongastos,o.vehiculoParaInscribir=r[0].vehiculoParaInscribir,o.prima=r[0].prima,o.plazo=r[0].plazo,o.libre=r[0].libre,o.montoPrima=r[0].libre,o.cedula=r[0].id_cedula,o.nombre=r[0].nombre,o.apellido1=r[0].apellido1,o.apellido2=r[0].apellido2,o.fechaNacimiento=r[0].fecha_nacimiento,o.fechaIngreso=r[0].antiguedad_laboral,o.correo=r[0].email,o.deudorTipo=r[0].id_tipopersona,o.propietario=r[0].propietario,o.asegurado=r[0].asegurado,o.firmaExterna=r[0].id_firmaexterna,o.inscripcion=r[0].id_tipopersonainscribe,o.usoSeguro=r[0].id_uso,o.telefono=r[0].telefono,"CREDIAUTOS"==o.nombreMarca||"NOVACIONES"==o.nombreMarca?o.esUsado=!0:o.esUsado=!1,o.badejaLoading=!1,e.resolve()}else console.log("sin datos"),e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function x(e){for(i=0;i<o.promociones.length;i++)e==o.promociones[i].idPromocion&&(o.selectedPromocion=o.promociones[i],E(o.promociones[i]));z()}function E(e){o.plazo1=e.plazo1,o.plazo2=e.plazo2,o.plazo3=e.plazo3,o.tasa1=e.tasa1,o.tasa2=e.tasa2,o.tasa3=e.tasa3}function T(e){for(i=0;i<o.annios.length;i++)e==o.annios[i].anno&&(o.selectedAnnio=o.annios[i])}function I(){o.selectedMoneda=o.monedas[0]}function N(e){if(0==e)for(i=0;i<o.bonificaciones.length;i++)0==o.bonificaciones[i].seguro&&0==o.bonificaciones[i].adicional&&(o.selectedBonificacion=o.bonificaciones[i]);else for(i=0;i<o.bonificaciones.length;i++)e==o.bonificaciones[i].id&&(o.selectedBonificacion=o.bonificaciones[i])}function B(e){if(0==e)o.selectedExtra={id:0};else for(i=0;i<o.extras.length;i++)e==o.extras[i].id&&(o.selectedExtra=o.extras[i])}function V(){var a=t.defer(),i=a.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/getDetallePDF.php",{idCaso:n.idCaso}).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),i}function R(){var a=t.defer(),i=a.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/getDetalleLeasingPDF.php",{idCaso:n.idCaso}).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),i}function U(){var e=t.defer(),a=e.promise;return o.extrasBandejaLoading=!0,o.extrasCotizacion=[],r.post("app/bandejaEntrada/detalleCotizacion/php/getExtrasByBandeja.php",{idBandeja:n.idCaso}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasCotizacion=r,o.extrasBandejaLoading=!1,e.resolve()}else o.extrasPromocion=[],o.extrasBandejaLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.routeParams=n,o.extrasCotizacion=[],o.esUsado=!1,o.libre=0,o.comision=-1,o.seguroTotal=-1,o.seguroMensual=-1;var J=p.encrypt(n.idCaso);String.prototype.replaceAll=function(o,e){return this.replace(new RegExp(o,"g"),e)},sustituir=J.replaceAll("/","-"),o.linkSolicitudCredito=sustituir,e.user&&e.rolesProcesos&&e.rolesMantenimientos?function(){var e=t.defer(),a=e.promise;return o.bonificacionesLoading=!0,o.bonificaciones=[],o.selectedPromocion?r.post("app/bonificaciones/php/getBonificaciones.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.bonificaciones=r,o.bonificacionesLoading=!1,e.resolve()}else o.bonificaciones=[],o.bonificacionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.bonificacionesLoading=!1,e.resolve()),a}().then(function(o){$().then(function(o){A().then(function(o){U(),D(),S(),M(),O(),_()})})}):a.path("/home"),o.openClientePdf=function(){o.detallePDFClienteLoading=!0,"0"==o.tipoPrestamo?V().then(function(e){-1!=o.comision&&(o.detallesPDF.comisionBancaria=o.comision.toString()),o.detallesPDF.seguroTotal=o.seguroTotal,o.detallesPDF.seguroMensual=o.seguroMensual,pdfMake.createPdf(l.impresionClientePDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFClienteLoading=!1}):R().then(function(e){-1!=o.comision&&(o.detallesPDF.comisionBancaria=o.comision.toString()),o.detallesPDF.seguroTotal=o.seguroTotal,o.detallesPDF.seguroMensual=o.seguroMensual,-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(m.impresionAnalistaLeasingOperativaPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(f.impresionAnalistaLeasingFinancieroPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFClienteLoading=!1})},o.openAnalistaPdf=function(){o.detallePDFAnalistaLoading=!0,"0"==o.tipoPrestamo?V().then(function(e){-1!=o.comision&&(o.detallesPDF.comisionBancaria=o.comision.toString()),o.detallesPDF.seguroTotal=o.seguroTotal,o.detallesPDF.seguroMensual=o.seguroMensual,pdfMake.createPdf(d.impresionAnalistaPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1}):R().then(function(e){-1!=o.comision&&(o.detallesPDF.comisionBancaria=o.comision.toString()),o.detallesPDF.seguroTotal=o.seguroTotal,o.detallesPDF.seguroMensual=o.seguroMensual,-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(m.impresionAnalistaLeasingOperativaPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(f.impresionAnalistaLeasingFinancieroPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1})},
o.preAprobar=function(){o.preAprobarLoading=!0,void 0===o.nombre?(alert("Falta nombre"),o.preAprobarLoading=!1):void 0===o.apellido1?(alert("Falta apellido1"),o.preAprobarLoading=!1):void 0===o.apellido2?(alert("Falta apellido2"),o.preAprobarLoading=!1):void 0===o.cedula?(alert("Falta cedula"),o.preAprobarLoading=!1):"00/00/0000"===o.fechaNacimiento?(alert("Falta fecha de Nacimiento"),o.preAprobarLoading=!1):"00/00/0000"===o.fechaIngreso?(alert("Falta fecha de Ingreso al trabajo"),o.preAprobarLoading=!1):void 0===o.salarioBruto?(alert("Falta salario Bruto"),o.preAprobarLoading=!1):void 0===o.vehiculo?(alert("Falta tipo de vehiculo"),o.preAprobarLoading=!1):void 0===o.precioConGastos?(alert("Faltan precio con gastos del vehiculo"),o.preAprobarLoading=!1):void 0===o.prima?(alert("Falta prima del vehiculo"),o.preAprobarLoading=!1):h().then(function(e){1==e.resultadoPreAprobacion?(alert("Pre aprobado con exito"),o.id_estado="1",o.preAprobarLoading=!1):(alert(e.mensajePreAprobacion),o.preAprobarLoading=!1)})},o.guardarCambios=function(){o.guardarLoading=!0,void 0==o.selectedPromocion||null==o.selectedPromocion?(alert("Debe seleccionar promocion"),o.guardarLoading=!1):void 0==o.selectedBonificacion||null==o.selectedBonificacion?(alert("Debe seleccionar bonificacion"),o.guardarLoading=!1):void 0==o.selectedAnnio||null==o.selectedAnnio?(alert("Debe selecionar aÃ±o"),o.guardarLoading=!1):(C(),b().then(function(e){o.guardarLoading=!0,P().then(function(e){v().then(function(e){o.guardarLoading=!1})})}))},o.onModeloChange=function(){if(o.promocionesLoading=!0,o.promociones=[],o.selectedModelo){var e={marca:o.nombreMarca,modelo:o.selectedModelo.modelo,id_tipo_prestamo:o.tipoPrestamo};r.post("app/bandejaEntrada/detalleCotizacion/php/getPromocionesByMarcaModelo.php",e).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);""!=r[0].descripcion&&a.push(r[0])}o.promociones=a,o.promocionesLoading=!1}else o.promociones=[],o.promocionesLoading=!1}).error(function(o,e){console.log(o)})}else o.promocionesLoading=!1},o.onPromocionChange=function(){o.selectedPromocion&&(E(o.selectedPromocion),S(),D(),O(),j())},o.borrarExtraPromocion=function(e){o.extrasPromocion.splice(e,1)},o.agregarExtraCotizacion=function(){o.extrasCotizacion.push(o.nuevoExtraCotizacion),o.nuevoExtraCotizacion=""},o.borrarExtraCotizacion=function(e){o.extrasCotizacion.splice(e,1)}}function AgregarAreaCreditoController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/areasCredito/agregarAreaCredito/agregarAreaCredito.php",{descripcion:o.descripcion}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarAreaCredito=function(){o.dataLoading=!0,t().then(function(o){r.path("/areascredito")})}}function agregarDetallesAlAreaController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/areasCredito/agregarDetallesAlArea/php/getDetallesByAreaId.php",{idAreaCredito:c.idAreaCredito}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.detallesAlArea=a,o.dataLoading=!1,o.totalItems=o.detallesAlArea.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.detallesAlArea=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/areasCredito/agregarDetallesAlArea/php/deleteDetalleDelArea.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.routeParams=c,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarDetalleAlArea=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.detallesAlArea,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function EditarAreaCreditoController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/areasCredito/editarAreaCredito/php/editarAreaCredito.php",{id:o.id,descripcion:o.descripcion}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/areasCredito/editarAreaCredito/php/getAreaCreditoById.php",{idAreaCredito:t.idAreaCredito}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.areaCredito=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarAreaCredito=function(){o.dataLoading=!0,s().then(function(o){r.path("/areascredito")})}}function DetalleController(o,e,a,r,n,t,s,c,l,d,p,u,g,m,f){function h(){var e=t.defer(),a=e.promise,i=o.salarioBruto-o.salarioNeto;o.gastos=i;var n=o.precioConGastos-o.gastosDelVehiculo;return o.precioSinGastos=n,atributos={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",primerNombreCliente:o.nombre,segundoNombreCliente:o.nombre,primerApellidoCliente:o.apellido1,segundoApellidoCliente:o.apellido2,nombreEmpresa:"",tipoIdentificacion:18,numeroIdentificacion:o.cedula,fechaNacimiento:o.fechaNacimiento,segmentoCotizador:1,antiguedadLaboral:o.fechaIngreso,ingresoActual:o.salarioBruto,gastos:i,tipoVehiculo:o.vehiculo,cuotaSolicitada:0,montoSolicitado:s.calcularSaldoFinanciar(o.precioConGastos,o.precioConGastos*(o.prima/100)),precioVehiculo:n},r.post("app/php/soapServicePreAprobarMonto.php",atributos).success(function(a){console.log(a),angular.isObject(a)?e.resolve(a.return):(o.error="No se pudo crear",e.reject(o.error))}).error(function(a,r){o.error="No se pudo crear",e.reject(a)}),a}function P(){var e=t.defer(),a=e.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/borrarExtras.php",{idBandeja:n.idCaso}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(alert("No se puede eliminar"),o.guardarLoading=!1,e.reject())}).error(function(o,a){console.log(o),e.reject(o)}),a}function v(){var e=t.defer(),a=e.promise;if(o.extrasCotizacion.length>0)for(i=0;i<o.extrasCotizacion.length;i++){var s={id_bandeja:n.idCaso,id_extra:o.extrasCotizacion[i].id};r.post("app/bandejaEntrada/detalleCotizacion/php/agregarExtrasBandeja.php",s).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.guardarLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.guardarLoading=!1,console.log(a),e.reject(a)})}else e.resolve();return a}function b(){var e=t.defer(),a=e.promise,i={idCaso:n.idCaso,id_estado:o.id_estado,tipo_vehiculo_a_comprar:o.vehiculo,placa:o.placaVehiculo,id_marca_modelo:o.selectedModelo.modelo,anno:o.selectedAnnio.anno,ingresobruto:o.salarioBruto,ingreso:o.salarioNeto,gastos:o.gastos,costovehiculo:o.precioSinGastos,id_bonificacion:o.selectedBonificacion.id,id_moneda:o.selectedMoneda.id_moneda,vehiculoParaInscribir:o.vehiculoParaInscribir,id_firmaexterna:o.firmaExterna,gastosvehiculo:o.gastosDelVehiculo,preciocongastos:o.precioConGastos,prima:o.prima,plazo:o.selectedPlazo,libre:o.montoPrima,id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,fecha_nacimiento:o.fechaNacimiento,antiguedad_laboral:o.fechaIngreso,email:o.correo,id_tipopersona:o.deudorTipo,telefono:o.telefono,propietario:o.propietario,id_tipopersonainscribe:o.inscripcion,asegurado:o.asegurado,id_uso:o.usoSeguro,id_promocion:o.selectedPromocion.idPromocion};return parseFloat(o.prima)<parseFloat(o.selectedPromocion.porcentaje)?(alert("La prima es inferior al minimo de la promocion"),o.guardarLoading=!1,e.resolve()):r.post("app/bandejaEntrada/detalleCotizacion/php/editarDetalles.php",i).success(function(a){angular.isObject(a)&&a.jsonSuccess?(o.guardarLoading=!1,e.resolve()):(o.guardarLoading=!1,e.resolve(a))}).error(function(o,a){console.log(o),e.reject(o)}),a}function C(){if(void 0===o.prima){if(void 0===o.montoPrima||o.montoPrima,o.montoPrima>0){var e=s.calcularMontoPrima(o.precioConGastos,o.montoPrima);o.prima=e}}else if(void 0===o.montoPrima)if(void 0===o.prima||null==o.prima)alert("Debe ingresar monto de prima del vehiculo o ingresar % de prima"),o.calcularLoading=!1;else{var a=s.calcularPrimaMonto(o.precioConGastos,o.prima);o.montoPrima=a}else if(null===o.montoPrima){var a=s.calcularPrimaMonto(o.precioConGastos,o.prima);o.montoPrima=a}else{var e=s.calcularMontoPrima(o.precioConGastos,o.montoPrima);o.prima=parseFloat(e)}}function F(){o.modelosLoading=!0,r.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:o.detalle.nombreMarca}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,L(),o.modelosLoading=!1}else o.modelos=[],o.modelosLoading=!1}).error(function(o,e){console.log(o)})}function L(){for(i=0;i<o.modelos.length;i++)o.modelos[i].modelo.trim()==o.detalle.id_marca_modelo.trim()&&(o.selectedModelo=o.modelos[i])}function A(){var e=t.defer(),a=e.promise;o.promocionesLoading=!0,o.promociones=[];var n={marca:o.nombreMarca,modelo:o.modelo,id_tipo_prestamo:o.tipoPrestamo};return r.post("app/bandejaEntrada/detalleCotizacion/php/getPromocionesByMarcaModelo.php",n).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);""!=n[0].descripcion&&r.push(n[0])}o.promociones=r,o.promocionesLoading=!1,x(o.detalle.id_promocion),e.resolve()}else o.promociones=[],o.promocionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function j(){o.plazosPromocion=[],o.plazosPromocion.push(o.selectedPromocion.plazo1),o.plazosPromocion.push(o.selectedPromocion.plazo1-12),o.plazosPromocion.push(o.selectedPromocion.plazo1-24),o.plazosPromocion.push(o.selectedPromocion.plazo1-36),o.selectedPlazo=o.plazosPromocion[0]}function z(){o.plazosPromocion=[],o.plazosPromocion.push(o.selectedPromocion.plazo1),o.plazosPromocion.push((o.selectedPromocion.plazo1-12).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-24).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-36).toString()),o.selectedPlazo=o.plazo}function D(){var e=t.defer(),a=e.promise;return o.anniosLoading=!0,o.annios=[],o.selectedPromocion?r.post("app/vendedor/php/getAnniosByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.annios=r,T(o.detalle.anno),o.anniosLoading=!1,e.resolve()}else o.annios=[],o.anniosLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.anniosLoading=!1,e.resolve()),a}function S(){var e=t.defer(),a=e.promise;return o.monedasLoading=!0,o.monedas=[],o.selectedPromocion?r.post("app/vendedor/php/getMonedasByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.monedas=r,I(),o.monedasLoading=!1,e.resolve()}else o.monedas=[],o.monedasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.monedasLoading=!1,e.resolve()),a}function M(){var e=t.defer(),a=e.promise;return o.bonificacionesLoading=!0,o.bonificaciones=[],o.selectedPromocion?r.post("app/bonificaciones/php/getBonificaciones.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.bonificaciones=r,N(o.detalle.id_bonificacion),o.bonificacionesLoading=!1,e.resolve()}else o.bonificaciones=[],o.bonificacionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.bonificacionesLoading=!1,e.resolve()),a}function O(){var e=t.defer(),a=e.promise;return o.extrasLoading=!0,o.extras=[],o.selectedPromocion?r.post("app/extras/php/getExtras.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extras=r,B(o.detalle.id_tecnologico),o.extrasLoading=!1,e.resolve()}else o.extras=[],o.extrasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.extrasLoading=!1,e.resolve()),a}function _(){var e=t.defer(),a=e.promise;return o.extrasPromocionLoading=!0,o.extrasPromocion=[],o.selectedPromocion?r.post("app/promociones/agregarDetalle/php/getExtrasByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasPromocion=r,o.extrasPromocionLoading=!1,e.resolve()}else o.extrasPromocion=[],o.extrasPromocionLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.extrasPromocionLoading=!1,e.resolve()),a}function $(){var e=t.defer(),a=e.promise;return o.badejaLoading=!0,r.post("app/bandejaEntrada/detalleCotizacion/php/getDetalleCotizacion.php",{idCaso:n.idCaso}).success(function(a){if(angular.isObject(a)){var r=JSON.parse(a);o.detalle=r[0],o.id=r[0].id,o.tipoPrestamo=r[0].id_tipo_prestamo,o.id_estado=r[0].id_estado,o.vehiculo=r[0].tipo_vehiculo_a_comprar,o.nombreMarca=r[0].nombreMarca,o.modelo=r[0].id_marca_modelo,F(),o.placaVehiculo=r[0].placa,o.salarioBruto=r[0].ingresobruto,o.salarioNeto=r[0].ingreso,o.gastos=r[0].gastos,o.precioSinGastos=r[0].costovehiculo,o.gastosDelVehiculo=r[0].gastosvehiculo,o.precioConGastos=r[0].preciocongastos,o.vehiculoParaInscribir=r[0].vehiculoParaInscribir,o.prima=r[0].prima,o.plazo=r[0].plazo,o.libre=r[0].libre,o.montoPrima=r[0].libre,o.cedula=r[0].id_cedula,o.nombre=r[0].nombre,o.apellido1=r[0].apellido1,o.apellido2=r[0].apellido2,o.fechaNacimiento=r[0].fecha_nacimiento,o.fechaIngreso=r[0].antiguedad_laboral,o.correo=r[0].email,o.deudorTipo=r[0].id_tipopersona,o.propietario=r[0].propietario,o.asegurado=r[0].asegurado,o.firmaExterna=r[0].id_firmaexterna,o.inscripcion=r[0].id_tipopersonainscribe,o.usoSeguro=r[0].id_uso,o.telefono=r[0].telefono,"CREDIAUTOS"==o.nombreMarca||"NOVACIONES"==o.nombreMarca||"TERCEROS"==o.nombreMarca?o.esUsado=!0:o.esUsado=!1,o.badejaLoading=!1,e.resolve()}else console.log("sin datos"),e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function x(e){for(i=0;i<o.promociones.length;i++)e==o.promociones[i].idPromocion&&(o.selectedPromocion=o.promociones[i],E(o.promociones[i]));z()}function E(e){o.plazo1=e.plazo1,o.plazo2=e.plazo2,o.plazo3=e.plazo3,o.tasa1=e.tasa1,o.tasa2=e.tasa2,o.tasa3=e.tasa3}function T(e){for(i=0;i<o.annios.length;i++)e==o.annios[i].anno&&(o.selectedAnnio=o.annios[i])}function I(){o.selectedMoneda=o.monedas[0]}function N(e){if(0==e)for(i=0;i<o.bonificaciones.length;i++)0==o.bonificaciones[i].seguro&&0==o.bonificaciones[i].adicional&&(o.selectedBonificacion=o.bonificaciones[i]);else for(i=0;i<o.bonificaciones.length;i++)e==o.bonificaciones[i].id&&(o.selectedBonificacion=o.bonificaciones[i])}function B(e){if(0==e)o.selectedExtra={id:0};else for(i=0;i<o.extras.length;i++)e==o.extras[i].id&&(o.selectedExtra=o.extras[i])}function V(){var a=t.defer(),i=a.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/getDetallePDF.php",{idCaso:n.idCaso}).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),i}function R(){var a=t.defer(),i=a.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/getDetalleLeasingPDF.php",{idCaso:n.idCaso}).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),i}function U(){var e=t.defer(),a=e.promise;return o.extrasBandejaLoading=!0,o.extrasCotizacion=[],r.post("app/bandejaEntrada/detalleCotizacion/php/getExtrasByBandeja.php",{idBandeja:n.idCaso}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasCotizacion=r,o.extrasBandejaLoading=!1,e.resolve()}else o.extrasPromocion=[],o.extrasBandejaLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.routeParams=n,o.extrasCotizacion=[],o.esUsado=!1,o.libre=0;var J=p.encrypt(n.idCaso);String.prototype.replaceAll=function(o,e){return this.replace(new RegExp(o,"g"),e)},sustituir=J.replaceAll("/","-"),o.linkSolicitudCredito=sustituir,e.user&&e.rolesProcesos&&e.rolesMantenimientos?function(){var e=t.defer(),a=e.promise;return o.bonificacionesLoading=!0,o.bonificaciones=[],o.selectedPromocion?r.post("app/bonificaciones/php/getBonificaciones.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.bonificaciones=r,o.bonificacionesLoading=!1,e.resolve()}else o.bonificaciones=[],o.bonificacionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.bonificacionesLoading=!1,e.resolve()),a}().then(function(o){$().then(function(o){A().then(function(o){U(),D(),S(),M(),O(),_()})})}):a.path("/home"),o.openClientePdf=function(){o.detallePDFClienteLoading=!0,"0"==o.tipoPrestamo?V().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,pdfMake.createPdf(l.impresionClientePDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFClienteLoading=!1}):R().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(u.impresionClienteLeasingOperativoPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(g.impresionClienteLeasingFinancieroPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFClienteLoading=!1})},o.openAnalistaPdf=function(){o.detallePDFAnalistaLoading=!0,"0"==o.tipoPrestamo?V().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,pdfMake.createPdf(d.impresionAnalistaPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1}):R().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(m.impresionAnalistaLeasingOperativaPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(f.impresionAnalistaLeasingFinancieroPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1})},o.preAprobar=function(){o.preAprobarLoading=!0,void 0===o.nombre?(alert("Falta nombre"),o.preAprobarLoading=!1):void 0===o.apellido1?(alert("Falta apellido1"),o.preAprobarLoading=!1):void 0===o.apellido2?(alert("Falta apellido2"),o.preAprobarLoading=!1):void 0===o.cedula?(alert("Falta cedula"),o.preAprobarLoading=!1):"00/00/0000"===o.fechaNacimiento?(alert("Falta fecha de Nacimiento"),o.preAprobarLoading=!1):"00/00/0000"===o.fechaIngreso?(alert("Falta fecha de Ingreso al trabajo"),o.preAprobarLoading=!1):void 0===o.salarioBruto?(alert("Falta salario Bruto"),o.preAprobarLoading=!1):void 0===o.vehiculo?(alert("Falta tipo de vehiculo"),o.preAprobarLoading=!1):void 0===o.precioConGastos?(alert("Faltan precio con gastos del vehiculo"),o.preAprobarLoading=!1):void 0===o.prima?(alert("Falta prima del vehiculo"),o.preAprobarLoading=!1):h().then(function(e){1==e.resultadoPreAprobacion?(alert("Pre aprobado con exito"),o.id_estado="1",o.preAprobarLoading=!1):(alert(e.mensajePreAprobacion),o.preAprobarLoading=!1)})},o.guardarCambios=function(){o.guardarLoading=!0,void 0==o.selectedPromocion||null==o.selectedPromocion?(alert("Debe seleccionar promocion"),o.guardarLoading=!1):void 0==o.selectedBonificacion||null==o.selectedBonificacion?(alert("Debe seleccionar bonificacion"),o.guardarLoading=!1):void 0==o.selectedAnnio||null==o.selectedAnnio?(alert("Debe selecionar aÃ±o"),o.guardarLoading=!1):(C(),b().then(function(e){o.guardarLoading=!0,P().then(function(e){v().then(function(e){o.guardarLoading=!1})})}))},o.onModeloChange=function(){if(o.promocionesLoading=!0,o.promociones=[],o.selectedModelo){var e={marca:o.nombreMarca,modelo:o.selectedModelo.modelo,id_tipo_prestamo:o.tipoPrestamo};r.post("app/bandejaEntrada/detalleCotizacion/php/getPromocionesByMarcaModelo.php",e).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);""!=r[0].descripcion&&a.push(r[0])}o.promociones=a,o.promocionesLoading=!1}else o.promociones=[],o.promocionesLoading=!1}).error(function(o,e){console.log(o)})}else o.promocionesLoading=!1},o.onPromocionChange=function(){o.selectedPromocion&&(E(o.selectedPromocion),M(),S(),D(),O(),j())},o.borrarExtraPromocion=function(e){o.extrasPromocion.splice(e,1)},o.agregarExtraCotizacion=function(){o.extrasCotizacion.push(o.nuevoExtraCotizacion),o.nuevoExtraCotizacion=""},o.borrarExtraCotizacion=function(e){o.extrasCotizacion.splice(e,1)}}function DetalleLeadsController(o,e,a,r,n,t,s,c,l,d,p){function u(){o.agenciasLoading=!0,r.post("app/agencias/php/getAgencias.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.agencias=a,o.agenciasLoading=!1}else o.agencias=[],o.agenciasLoading=!1}).error(function(o,e){console.log(o)})}function g(){o.marcasLoading=!0;var e=t.defer(),a=e.promise;return r.post("app/marcas/php/getMarcas.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.marcas=r,o.marcasLoading=!1,e.resolve()}else o.marcas=[],o.marcasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function m(){o.dataLoading=!0,r.post("app/monedas/php/getMonedas.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.monedas=a,o.dataLoading=!1}else o.monedas=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}o.routeParams=n,o.esUsado=!1,o.libre=0,function(){var e=t.defer(),a=e.promise;return o.badejaLoading=!0,r.post("app/bandejaLeads/detalleCotizacion/php/getDetalleCotizacion.php",{idCaso:n.idCaso}).success(function(a){if(angular.isObject(a)){var r=JSON.parse(a);o.detalle=r[0],o.id=r[0].id,o.id_estado=r[0].id_estado,o.vehiculo=r[0].tipo_vehiculo_a_comprar,o.nombreMarca=r[0].nombreMarca,o.modelo=r[0].id_marca_modelo,o.placaVehiculo=r[0].placa,o.salarioBruto=r[0].ingresobruto,o.salarioNeto=r[0].ingreso,o.gastos=r[0].gastos,o.precioSinGastos=r[0].costovehiculo,o.gastosDelVehiculo=r[0].gastosvehiculo,o.precioConGastos=r[0].preciocongastos,o.vehiculoParaInscribir=r[0].vehiculoParaInscribir,o.prima=r[0].prima,o.libre=r[0].libre,o.cedula=r[0].id_cedula,o.nombre=r[0].nombre,o.apellido1=r[0].apellido1,o.apellido2=r[0].apellido2,o.fechaNacimiento=r[0].fecha_nacimiento,o.fechaIngreso=r[0].antiguedad_laboral,o.correo=r[0].email,o.deudorTipo=r[0].id_tipopersona,o.propietario=r[0].propietario,o.asegurado=r[0].asegurado,o.firmaExterna=r[0].id_firmaexterna,o.inscripcion=r[0].id_tipopersonainscribe,o.usoSeguro=r[0].id_uso,o.telefono=r[0].telefono,"CREDIAUTOS"==o.nombreMarca||"NOVACIONES"==o.nombreMarca||"TERCEROS"==o.nombreMarca?o.esUsado=!0:o.esUsado=!1,o.badejaLoading=!1,e.resolve()}else console.log("sin datos"),e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}().then(function(o){m(),u(),g()}),o.guardarCambios=function(){o.guardarLoading=!0;var e=t.defer(),a=e.promise,i={idCaso:n.idCaso,id_estado:o.id_estado,agencia:o.selectedAgencia.id,tipo_vehiculo_a_comprar:o.vehiculo,id_marca:o.selectedMarca.id,id_marca_modelo:o.selectedModelo.modelo,ingresobruto:o.salarioBruto,ingreso:o.salarioNeto,costovehiculo:o.precioSinGastos,id_moneda:o.selectedMoneda.id,gastosvehiculo:o.gastosDelVehiculo,preciocongastos:o.precioConGastos,prima:o.prima,libre:o.libre,id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,antiguedad_laboral:o.fechaIngreso,email:o.correo,telefono:o.telefono};return r.post("app/bandejaLeads/detalleCotizacion/php/editarDetalles.php",i).success(function(a){angular.isObject(a)&&a.jsonSuccess?(o.guardarLoading=!1,e.resolve()):(o.guardarLoading=!1,e.resolve(a))}).error(function(o,a){console.log(o),e.reject(o)}),a},o.onMarcasChange=function(){o.modelosLoading=!0,"CREDIAUTOS"==o.selectedMarca.descripcion||"NOVACIONES"==o.selectedMarca.descripcion||"TERCEROS"==o.selectedMarca.descripcion?o.vehiculo="2":o.vehiculo="1",o.modelos=[],o.promociones=[],r.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:o.selectedMarca.descripcion}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,o.modelosLoading=!1}else o.modelos=[],o.modelosLoading=!1}).error(function(o,e){console.log(o)})},o.borrarExtraCotizacion=function(e){o.extrasCotizacion.splice(e,1)}}function DetalleVendedorController(o,e,a,r,n,t,s,c,l,d,p,u,g){function m(){var e=t.defer(),a=e.promise,i=o.salarioBruto-o.salarioNeto;o.gastos=i;var n=o.precioConGastos-o.gastosDelVehiculo;return o.precioSinGastos=n,atributos={url:"http://186.177.21.110:8080/CotizadorSVNPru/PreAprobacionWS?wsdl",primerNombreCliente:o.nombre,segundoNombreCliente:o.nombre,primerApellidoCliente:o.apellido1,segundoApellidoCliente:o.apellido2,nombreEmpresa:"",tipoIdentificacion:18,numeroIdentificacion:o.cedula,fechaNacimiento:o.fechaNacimiento,segmentoCotizador:1,antiguedadLaboral:o.fechaIngreso,ingresoActual:o.salarioBruto,gastos:i,tipoVehiculo:o.vehiculo,cuotaSolicitada:0,montoSolicitado:s.calcularSaldoFinanciar(o.precioConGastos,o.precioConGastos*(o.prima/100)),precioVehiculo:n},r.post("app/php/soapServicePreAprobarMonto.php",atributos).success(function(a){console.log(a),angular.isObject(a)?e.resolve(a.return):(o.error="No se pudo crear",e.reject(o.error))}).error(function(a,r){o.error="No se pudo crear",e.reject(a)}),a}function f(){var e=t.defer(),a=e.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/borrarExtras.php",{idBandeja:n.idCaso}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(alert("No se puede eliminar"),o.guardarLoading=!1,e.reject())}).error(function(o,a){console.log(o),e.reject(o)}),a}function h(){var e=t.defer(),a=e.promise;if(o.extrasCotizacion.length>0)for(i=0;i<o.extrasCotizacion.length;i++){var s={id_bandeja:n.idCaso,id_extra:o.extrasCotizacion[i].id};r.post("app/bandejaEntrada/detalleCotizacion/php/agregarExtrasBandeja.php",s).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.guardarLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.guardarLoading=!1,console.log(a),e.reject(a)})}else e.resolve();return a}function P(){var e=t.defer(),a=e.promise,i={idCaso:n.idCaso,id_estado:o.id_estado,tipo_vehiculo_a_comprar:o.vehiculo,placa:o.placaVehiculo,id_marca_modelo:o.selectedModelo.modelo,anno:o.selectedAnnio.anno,ingresobruto:o.salarioBruto,ingreso:o.salarioNeto,gastos:o.gastos,costovehiculo:o.precioSinGastos,id_bonificacion:o.selectedBonificacion.id,id_moneda:o.selectedMoneda.id_moneda,vehiculoParaInscribir:o.vehiculoParaInscribir,id_firmaexterna:o.firmaExterna,gastosvehiculo:o.gastosDelVehiculo,preciocongastos:o.precioConGastos,prima:o.prima,plazo:o.selectedPlazo,libre:o.montoPrima,id_cedula:o.cedula,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,fecha_nacimiento:o.fechaNacimiento,antiguedad_laboral:o.fechaIngreso,email:o.correo,id_tipopersona:o.deudorTipo,telefono:o.telefono,propietario:o.propietario,id_tipopersonainscribe:o.inscripcion,asegurado:o.asegurado,id_uso:o.usoSeguro,id_promocion:o.selectedPromocion.idPromocion};return parseFloat(o.prima)<parseFloat(o.selectedPromocion.porcentaje)?(alert("La prima es inferior al minimo de la promocion"),o.guardarLoading=!1,e.resolve()):r.post("app/bandejaEntrada/detalleCotizacion/php/editarDetalles.php",i).success(function(a){angular.isObject(a)&&a.jsonSuccess?(o.guardarLoading=!1,e.resolve()):(o.guardarLoading=!1,e.resolve(a))}).error(function(o,a){console.log(o),e.reject(o)}),a}function v(){if(void 0===o.prima){if(void 0===o.montoPrima||o.montoPrima,o.montoPrima>0){var e=s.calcularMontoPrima(o.precioConGastos,o.montoPrima);o.prima=e}}else if(void 0===o.montoPrima)if(void 0===o.prima||null==o.prima)alert("Debe ingresar monto de prima del vehiculo o ingresar % de prima"),o.calcularLoading=!1;else{var a=s.calcularPrimaMonto(o.precioConGastos,o.prima);o.montoPrima=a}else if(null===o.montoPrima){var a=s.calcularPrimaMonto(o.precioConGastos,o.prima);o.montoPrima=a}else{var e=s.calcularMontoPrima(o.precioConGastos,o.montoPrima);o.prima=parseFloat(e)}}function b(){o.modelosLoading=!0,r.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:o.detalle.nombreMarca}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,C(),o.modelosLoading=!1}else o.modelos=[],o.modelosLoading=!1}).error(function(o,e){console.log(o)})}function C(){for(i=0;i<o.modelos.length;i++)o.modelos[i].modelo.trim()==o.detalle.id_marca_modelo.trim()&&(o.selectedModelo=o.modelos[i])}function F(){var e=t.defer(),a=e.promise;o.promocionesLoading=!0,o.promociones=[];var n={marca:o.nombreMarca,modelo:o.modelo,id_tipo_prestamo:o.tipoPrestamo};return r.post("app/bandejaEntrada/detalleCotizacion/php/getPromocionesByMarcaModelo.php",n).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);""!=n[0].descripcion&&r.push(n[0])}o.promociones=r,o.promocionesLoading=!1,_(o.detalle.id_promocion),e.resolve()}else o.promociones=[],o.promocionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function L(){o.plazosPromocion=[],o.plazosPromocion.push(o.selectedPromocion.plazo1),o.plazosPromocion.push(o.selectedPromocion.plazo1-12),o.plazosPromocion.push(o.selectedPromocion.plazo1-24),o.plazosPromocion.push(o.selectedPromocion.plazo1-36),o.selectedPlazo=o.plazosPromocion[0]}function A(){o.plazosPromocion=[],o.plazosPromocion.push(o.selectedPromocion.plazo1),o.plazosPromocion.push((o.selectedPromocion.plazo1-12).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-24).toString()),o.plazosPromocion.push((o.selectedPromocion.plazo1-36).toString()),o.selectedPlazo=o.plazo}function j(){var e=t.defer(),a=e.promise;return o.anniosLoading=!0,o.annios=[],o.selectedPromocion?r.post("app/vendedor/php/getAnniosByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.annios=r,x(o.detalle.anno),o.anniosLoading=!1,e.resolve()}else o.annios=[],o.anniosLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.anniosLoading=!1,e.resolve()),a}function z(){var e=t.defer(),a=e.promise;return o.monedasLoading=!0,o.monedas=[],o.selectedPromocion?r.post("app/vendedor/php/getMonedasByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.monedas=r,E(),o.monedasLoading=!1,e.resolve()}else o.monedas=[],o.monedasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),
e.reject(o)}):(o.monedasLoading=!1,e.resolve()),a}function D(){var e=t.defer(),a=e.promise;return o.bonificacionesLoading=!0,o.bonificaciones=[],o.selectedPromocion?r.post("app/bonificaciones/php/getBonificaciones.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.bonificaciones=r,T(o.detalle.id_bonificacion),o.bonificacionesLoading=!1,e.resolve()}else o.bonificaciones=[],o.bonificacionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.bonificacionesLoading=!1,e.resolve()),a}function S(){var e=t.defer(),a=e.promise;return o.extrasLoading=!0,o.extras=[],o.selectedPromocion?r.post("app/extras/php/getExtras.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extras=r,I(o.detalle.id_tecnologico),o.extrasLoading=!1,e.resolve()}else o.extras=[],o.extrasLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.extrasLoading=!1,e.resolve()),a}function M(){var e=t.defer(),a=e.promise;return o.extrasPromocionLoading=!0,o.extrasPromocion=[],o.selectedPromocion?r.post("app/promociones/agregarDetalle/php/getExtrasByPromocion.php",{idPromocion:o.selectedPromocion.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasPromocion=r,o.extrasPromocionLoading=!1,e.resolve()}else o.extrasPromocion=[],o.extrasPromocionLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.extrasPromocionLoading=!1,e.resolve()),a}function O(){var e=t.defer(),a=e.promise;return o.badejaLoading=!0,r.post("app/bandejaEntrada/detalleCotizacion/php/getDetalleCotizacion.php",{idCaso:n.idCaso}).success(function(a){if(angular.isObject(a)){var r=JSON.parse(a);o.detalle=r[0],o.id=r[0].id,o.tipoPrestamo=r[0].id_tipo_prestamo,o.id_estado=r[0].id_estado,o.vehiculo=r[0].tipo_vehiculo_a_comprar,o.nombreMarca=r[0].nombreMarca,o.modelo=r[0].id_marca_modelo,b(),o.placaVehiculo=r[0].placa,o.salarioBruto=r[0].ingresobruto,o.salarioNeto=r[0].ingreso,o.gastos=r[0].gastos,o.precioSinGastos=r[0].costovehiculo,o.gastosDelVehiculo=r[0].gastosvehiculo,o.precioConGastos=r[0].preciocongastos,o.vehiculoParaInscribir=r[0].vehiculoParaInscribir,o.prima=r[0].prima,o.plazo=r[0].plazo,o.libre=r[0].libre,o.montoPrima=r[0].libre,o.cedula=r[0].id_cedula,o.nombre=r[0].nombre,o.apellido1=r[0].apellido1,o.apellido2=r[0].apellido2,o.fechaNacimiento=r[0].fecha_nacimiento,o.fechaIngreso=r[0].antiguedad_laboral,o.correo=r[0].email,o.deudorTipo=r[0].id_tipopersona,o.propietario=r[0].propietario,o.asegurado=r[0].asegurado,o.firmaExterna=r[0].id_firmaexterna,o.inscripcion=r[0].id_tipopersonainscribe,o.usoSeguro=r[0].id_uso,o.telefono=r[0].telefono,"CREDIAUTOS"==o.nombreMarca||"NOVACIONES"==o.nombreMarca||"TERCEROS"==o.nombreMarca?o.esUsado=!0:o.esUsado=!1,o.badejaLoading=!1,e.resolve()}else console.log("sin datos"),e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}function _(e){for(i=0;i<o.promociones.length;i++)e==o.promociones[i].idPromocion&&(o.selectedPromocion=o.promociones[i],$(o.promociones[i]));A()}function $(e){o.plazo1=e.plazo1,o.plazo2=e.plazo2,o.plazo3=e.plazo3,o.tasa1=e.tasa1,o.tasa2=e.tasa2,o.tasa3=e.tasa3}function x(e){for(i=0;i<o.annios.length;i++)e==o.annios[i].anno&&(o.selectedAnnio=o.annios[i])}function E(){o.selectedMoneda=o.monedas[0]}function T(e){if(0==e)for(i=0;i<o.bonificaciones.length;i++)0==o.bonificaciones[i].seguro&&0==o.bonificaciones[i].adicional&&(o.selectedBonificacion=o.bonificaciones[i]);else for(i=0;i<o.bonificaciones.length;i++)e==o.bonificaciones[i].id&&(o.selectedBonificacion=o.bonificaciones[i])}function I(e){if(0==e)o.selectedExtra={id:0};else for(i=0;i<o.extras.length;i++)e==o.extras[i].id&&(o.selectedExtra=o.extras[i])}function N(){var a=t.defer(),i=a.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/getDetallePDF.php",{idCaso:n.idCaso}).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),i}function B(){var a=t.defer(),i=a.promise;return r.post("app/bandejaEntrada/detalleCotizacion/php/getDetalleLeasingPDF.php",{idCaso:n.idCaso}).success(function(r){if(angular.isObject(r)){var i=JSON.parse(r[0]);o.detallesPDF=i[0],d1=o.detallesPDF.plazo1-o.detallesPDF.plazo2,d2=o.detallesPDF.plazo2-o.detallesPDF.plazo3,o.detallesPDF.plazo1=o.selectedPlazo,o.detallesPDF.plazo2=o.detallesPDF.plazo1-d1,o.detallesPDF.plazo3=o.detallesPDF.plazo2-d2,o.detallesPDF.user=e.user,a.resolve()}else o.detallesPDF=[],a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),i}function V(){var e=t.defer(),a=e.promise;return o.extrasBandejaLoading=!0,o.extrasCotizacion=[],r.post("app/bandejaEntrada/detalleCotizacion/php/getExtrasByBandeja.php",{idBandeja:n.idCaso}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasCotizacion=r,o.extrasBandejaLoading=!1,e.resolve()}else o.extrasPromocion=[],o.extrasBandejaLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.routeParams=n,o.extrasCotizacion=[],o.esUsado=!1,o.libre=0;var R=p.encrypt(n.idCaso);String.prototype.replaceAll=function(o,e){return this.replaceAll(new RegExp(o,"g"),e)},sustituir=R.replace("/","-"),o.linkSolicitudCredito=sustituir,e.user&&e.rolesProcesos&&e.rolesMantenimientos?function(){var e=t.defer(),a=e.promise;return o.bonificacionesLoading=!0,o.bonificaciones=[],o.selectedPromocion?r.post("app/bonificaciones/php/getBonificaciones.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.bonificaciones=r,o.bonificacionesLoading=!1,e.resolve()}else o.bonificaciones=[],o.bonificacionesLoading=!1,e.resolve()}).error(function(o,a){console.log(o),e.reject(o)}):(o.bonificacionesLoading=!1,e.resolve()),a}().then(function(o){O().then(function(o){F().then(function(o){V(),j(),z(),D(),S(),M()})})}):a.path("/home"),o.openClientePdf=function(){o.detallePDFClienteLoading=!0,"0"==o.tipoPrestamo?N().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,pdfMake.createPdf(l.impresionClientePDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFClienteLoading=!1}):B().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(u.impresionClienteLeasingOperativoPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(g.impresionClienteLeasingFinancieroPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFClienteLoading=!1})},o.openAnalistaPdf=function(){o.detallePDFAnalistaLoading=!0,"0"==o.tipoPrestamo?N().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,pdfMake.createPdf(d.impresionAnalistaPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1}):B().then(function(e){o.detallesPDF.seguroTotal=-1,o.detallesPDF.seguroMensual=-1,-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("OPERATIVO")&&pdfMake.createPdf(impresionAnalistaLeasingOperativoService.impresionAnalistaLeasingOperativaPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),-1!=o.detallesPDF.nombrePromocion.toUpperCase().search("FINANCIERO")&&pdfMake.createPdf(impresionAnalistaLeasingFinancieroService.impresionAnalistaLeasingFinancieroPDF(o.detallesPDF,o.extrasCotizacion,o.extrasPromocion)).open(),o.detallePDFAnalistaLoading=!1})},o.preAprobar=function(){o.preAprobarLoading=!0,void 0===o.nombre?(alert("Falta nombre"),o.preAprobarLoading=!1):void 0===o.apellido1?(alert("Falta apellido1"),o.preAprobarLoading=!1):void 0===o.apellido2?(alert("Falta apellido2"),o.preAprobarLoading=!1):void 0===o.cedula?(alert("Falta cedula"),o.preAprobarLoading=!1):"00/00/0000"===o.fechaNacimiento?(alert("Falta fecha de Nacimiento"),o.preAprobarLoading=!1):"00/00/0000"===o.fechaIngreso?(alert("Falta fecha de Ingreso al trabajo"),o.preAprobarLoading=!1):void 0===o.salarioBruto?(alert("Falta salario Bruto"),o.preAprobarLoading=!1):void 0===o.vehiculo?(alert("Falta tipo de vehiculo"),o.preAprobarLoading=!1):void 0===o.precioConGastos?(alert("Faltan precio con gastos del vehiculo"),o.preAprobarLoading=!1):void 0===o.prima?(alert("Falta prima del vehiculo"),o.preAprobarLoading=!1):m().then(function(e){1==e.resultadoPreAprobacion?(alert("Pre aprobado con exito"),o.id_estado="1",o.preAprobarLoading=!1):(alert(e.mensajePreAprobacion),o.preAprobarLoading=!1)})},o.guardarCambios=function(){o.guardarLoading=!0,void 0==o.selectedPromocion||null==o.selectedPromocion?(alert("Debe seleccionar promocion"),o.guardarLoading=!1):void 0==o.selectedBonificacion||null==o.selectedBonificacion?(alert("Debe seleccionar bonificacion"),o.guardarLoading=!1):void 0==o.selectedAnnio||null==o.selectedAnnio?(alert("Debe selecionar aÃ±o"),o.guardarLoading=!1):(v(),P().then(function(e){o.guardarLoading=!0,f().then(function(e){h().then(function(e){o.guardarLoading=!1})})}))},o.onModeloChange=function(){if(o.promocionesLoading=!0,o.promociones=[],o.selectedModelo){var e={marca:o.nombreMarca,modelo:o.selectedModelo.modelo,id_tipo_prestamo:o.tipoPrestamo};r.post("app/bandejaEntrada/detalleCotizacion/php/getPromocionesByMarcaModelo.php",e).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);""!=r[0].descripcion&&a.push(r[0])}o.promociones=a,o.promocionesLoading=!1}else o.promociones=[],o.promocionesLoading=!1}).error(function(o,e){console.log(o)})}else o.promocionesLoading=!1},o.onPromocionChange=function(){o.selectedPromocion&&($(o.selectedPromocion),z(),j(),S(),L())},o.borrarExtraPromocion=function(e){o.extrasPromocion.splice(e,1)},o.agregarExtraCotizacion=function(){o.extrasCotizacion.push(o.nuevoExtraCotizacion),o.nuevoExtraCotizacion=""},o.borrarExtraCotizacion=function(e){o.extrasCotizacion.splice(e,1)}}function AgregarBonificacionController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/bonificaciones/agregarBonificacion/agregarBonificacion.php",{seguro:o.seguro,adicional:o.adicional}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarBonificacion=function(){o.dataLoading=!0,t().then(function(o){r.path("/bonificaciones")})}}function EditarBonificacionController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/bonificaciones/editarBonificacion/php/editarBonificacion.php",{id:o.id,seguro:o.seguro,adicional:o.adicional}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/bonificaciones/editarBonificacion/php/getBonificacionById.php",{idBonificacion:t.idBonificacion}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.bonificacion=a[0],o.id=a[0].id,o.seguro=a[0].seguro,o.adicional=a[0].adicional,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarBonificacion=function(){o.dataLoading=!0,s().then(function(o){r.path("/bonificaciones")})}}function encabezado(){return{templateUrl:"app/directivas/encabezado/encabezado.html",controller:"EncabezadoController"}}function EncabezadoController(o,e,a,r,n,t,s,c){function l(a){o.nombreApellidoLoading=!0;var r=t.defer(),i=r.promise;return n.post("app/login/php/login.php",{username:a}).success(function(a){var i=JSON.parse(a);e.user=i[0],o.user=e.user,o.nombreApellidoLoading=!1,r.resolve(i[0])}).error(function(e,a){console.log(e),o.nombreApellidoLoading=!1,r.reject(e)}),i}function d(){var a=t.defer(),r=a.promise;return n.post("app/login/php/roles.php",{id:e.user.id}).success(function(r){if(angular.isObject(r)){var n=[],t=[{admin:"0"}];for(i=0;i<r.length;i++){var s=JSON.parse(r[i]),c=p(s[0]);"bandejaentrada"==c.id||"bandejavendedor"==c.id||"bandejaleads"==c.id||"bandejaadministrador"==c.id||"ejecutivo"==c.id||"vendedor"==c.id?n.push(c):t.push(c)}e.rolesProcesos=n,e.rolesMantenimientos=t,o.rolesProcesos=e.rolesProcesos,o.rolesMantenimientos=e.rolesMantenimientos,a.resolve()}else o.rolesProcesos={},o.rolesMantenimientos={},a.resolve()}).error(function(o,e){console.log(o),a.reject(o)}),r}function p(o){var o;switch(o.id_pantalla){case"agencias":o={nombre:"Agencias",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"annos":o={nombre:"AÃ±os",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"bandejaadministrador":o={nombre:"Bandeja de Administrador",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"bandejaentrada":o={nombre:"Bandeja de Entrada",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"bandejaleads":o={nombre:"Bandeja de Leads",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"bandejavendedor":o={nombre:"Bandeja de Vendedor",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"bonificaciones":o={nombre:"Bonificaciones",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"ejecutivo":o={nombre:"Ejecutivo",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"lineafinanciera":o={nombre:"Linea Financiera",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"marcas":o={nombre:"Marcas",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"monedas":o={nombre:"Monedas",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"productobanco":o={nombre:"Producto Banco",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"promociones":o={nombre:"Promociones",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"roles":o={nombre:"Roles",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"seccion":o={nombre:"Seccion",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"subaplicacion":o={nombre:"Sub Aplicacion",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"extras":o={nombre:"Extras",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"seguros":o={nombre:"Seguros",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"segurosLeasing":o={nombre:"Seguros Leasing",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"areascredito":o={nombre:"Areas de Credito",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"usuarios":o={nombre:"Usuarios",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"variables":o={nombre:"Variables",activo:o.activo,id:o.id_pantalla,admin:o.admin};break;case"vendedor":o={nombre:"Vendedor",activo:o.activo,id:o.id_pantalla,admin:o.admin}}return o}!function(){if(s.cookie.get("user"))if(e.user&&e.rolesProcesos&&e.rolesMantenimientos)o.user=e.user,o.rolesProcesos=e.rolesProcesos,o.rolesMantenimientos=e.rolesMantenimientos;else{o.loading=!0;var a=c.decrypt(s.cookie.get("user"));l(a).then(function(e){d().then(function(e){o.loading=!1})})}else r.path("/")}(),o.salir=function(){s.cookie.clearAll(),e.user=null,e.roles=null,e.rolesProcesos=null,e.rolesMantenimientos=null,o.user=null,o.roles=null,o.rolesProcesos=null,o.rolesMantenimientos=null,r.path("/")}}function menuRoles(){return{templateUrl:"app/directivas/menuRoles/menuRoles.html",controller:"MenuRolesController"}}function MenuRolesController(o,e,a,r,i){o.imgLoading=a.img,o.user=e.user,o.rolesProcesos=e.rolesProcesos,o.rolesMantenimientos=e.rolesMantenimientos,o.$route=i,o.status={isProcesosOpen:function(){switch(i.current.activetab){case"bandejaentrada":case"bandejaadministrador":case"bandejaleads":case"bandejavendedor":case"ejecutivo":case"vendedor":return!0}}(),isMantenimientosOpen:function(){switch(i.current.activetab){case"agencias":case"annos":case"bonificaciones":case"lineafinanciera":case"marcas":case"monedas":case"productobanco":case"promociones":case"roles":case"seccion":case"seguros":case"segurosLeasing":case"subaplicacion":case"extras":case"areascredito":case"usuarios":case"variables":return!0}}()}}function AgregarExtraController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise,r={descripcion:o.descripcion,moneda:o.moneda,monto:o.monto,cuota:o.cuota};return i.post("app/extras/agregarExtra/agregarExtra.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarExtra=function(){o.dataLoading=!0,t().then(function(o){r.path("/extras")})}}function EditarExtraController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise,r={id:o.id,descripcion:o.descripcion,moneda:o.moneda,monto:o.monto,cuota:o.cuota};return i.post("app/extras/editarExtra/php/editarExtra.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/extras/editarExtra/php/getExtraById.php",{idExtra:t.idExtra}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.extra=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.moneda=a[0].moneda,o.monto=a[0].monto,o.cuota=a[0].cuota,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarExtra=function(){o.dataLoading=!0,s().then(function(o){r.path("/extras")})}}function AgregarLineaFinancieraController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/lineaFinanciera/agregarLineaFinanciera/agregarLineaFinanciera.php",{codigo:o.codigo,descripcion:o.descripcion}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarLineaFinanciera=function(){o.dataLoading=!0,t().then(function(o){r.path("/lineafinanciera")})}}function EditarLineaFinancieraController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/lineaFinanciera/editarLineaFinanciera/php/editarLineaFinanciera.php",{id:o.id,codigo:o.codigo,descripcion:o.descripcion}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/lineaFinanciera/editarLineaFinanciera/php/getLineaFinancieraById.php",{idLineaFinanciera:t.idLineaFinanciera}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.lineaFinanciera=a[0],o.id=a[0].id,o.codigo=a[0].codigo,o.descripcion=a[0].descripcion,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarLineaFinanciera=function(){o.dataLoading=!0,s().then(function(o){r.path("/lineafinanciera")})}}function AgregarMarcaController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/marcas/agregarMarca/agregarMarca.php",{descripcion:o.descripcion}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarMarca=function(){o.dataLoading=!0,t().then(function(o){r.path("/marcas")})}}function AgregarModelosController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:c.descripcionMarca}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,o.dataLoading=!1,o.totalItems=o.modelos.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.modelos=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/marcas/agregarModelos/php/deleteModelo.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():a.reject(o.error)}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},o.routeParams=c,l(),o.borrarModelo=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.modelos,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function EditarMarcaController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/marcas/editarMarca/php/editarMarca.php",{id:o.id,descripcion:o.descripcion}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/marcas/editarMarca/php/getMarcaById.php",{idMarca:t.idMarca}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.marca=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarMarca=function(){o.dataLoading=!0,s().then(function(o){r.path("/marcas")})}}function AgregarMonedaController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/monedas/agregarMoneda/agregarMoneda.php",{descripcion:o.descripcion}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarMoneda=function(){o.dataLoading=!0,t().then(function(o){r.path("/monedas")})}}function EditarMonedaController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/monedas/editarMoneda/php/editarMoneda.php",{id:o.id,descripcion:o.descripcion}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/monedas/editarMoneda/php/getMonedaById.php",{idMoneda:t.idMoneda}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.moneda=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarMoneda=function(){o.dataLoading=!0,s().then(function(o){r.path("/monedas")})}}function AgregarProductoBancoController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/productoBanco/agregarProductoBanco/agregarProductoBanco.php",{codigo:o.codigo,descripcion:o.descripcion}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarProductoBanco=function(){o.dataLoading=!0,t().then(function(o){r.path("/productobanco")})}}function EditarProductoBancoController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/productoBanco/editarProductoBanco/php/editarProductoBanco.php",{id:o.id,codigo:o.codigo,descripcion:o.descripcion}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/productoBanco/editarProductoBanco/php/getProductoBancoById.php",{idProductoBanco:t.idProductoBanco}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.productoBanco=a[0],o.id=a[0].id,o.codigo=a[0].codigo,o.descripcion=a[0].descripcion,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarProductoBanco=function(){o.dataLoading=!0,s().then(function(o){r.path("/productobanco")})}}function AgregarPantallasAlRolController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/roles/agregarPantallasAlRol/php/getPantallasByRolId.php",{idRol:c.idRol}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.pantallasConRoles=a,o.dataLoading=!1,o.totalItems=o.pantallasConRoles.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.pantallasConRoles=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(o){var e=t.defer(),a=e.promise;return n.post("app/roles/agregarPantallasAlRol/php/deletePantallaDelRol.php",{idRol:c.idRol,id:o}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},o.routeParams=c,l(),o.borrarPantallaConRol=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.pantallasConRoles,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarRolController(o,e,a,r,n,t){function s(){var e=t.defer(),a=e.promise,r={descripcion:o.descripcion,id_marca:o.id_marca,id_tipoventas:o.id_tipoventas,admin:o.admin,activo:o.activo};return n.post("app/roles/agregarRol/agregarRol.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}function c(){var e=t.defer(),a=e.promise;return n.post("app/roles/agregarRol/php/getAreaCredito.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.areas=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/roles/agregarRol/php/getMarcas.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.marcas=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}().then(function(e){c().then(function(e){o.dataLoading=!1})}),o.agregarRol=function(){o.dataLoading=!0,s().then(function(o){r.path("/roles")})}}function AgregarUsuariosAlRolController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/roles/agregarUsuariosAlRol/php/getUsuariosByRolId.php",{idRol:c.idRol}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.usuariosConRoles=a,o.dataLoading=!1,o.totalItems=o.usuariosConRoles.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.dataLoading=!1,o.usuariosConRoles=[]}).error(function(o,e){console.log(o)})}function d(o){var e=t.defer(),a=e.promise;return n.post("app/roles/agregarUsuariosAlRol/php/deleteUsuarioDelRol.php",{id:o}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,o.currentPage=0,o.pageSize=10,o.search={},o.routeParams=c,l(),o.borrarUsuarioConRol=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.usuariosConRoles,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function EditarRolController(o,e,a,r,n,t,s){function c(){n.post("app/roles/editarRol/php/getRolById.php",{idRol:s.idRol}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.unRol=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.id_marca=a[0].id_marca,o.id_tipoventas=a[0].id_tipoventas,o.admin=a[0].admin,o.activo=a[0].activo,o.dataLoading=!1}else console.log("sin datos")}).error(function(o,e){console.log(o)})}function l(){var e=t.defer(),a=e.promise,r={id:o.id,descripcion:o.descripcion,id_marca:o.id_marca,id_tipoventas:o.id_tipoventas,admin:o.admin,activo:o.activo};return n.post("app/roles/editarRol/php/editarRol.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}function d(){var e=t.defer(),a=e.promise;return n.post("app/roles/agregarRol/php/getAreaCredito.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.areas=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/roles/agregarRol/php/getMarcas.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.marcas=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}().then(function(o){d().then(function(o){c()})}),o.editarRol=function(){o.dataLoading=!0,l().then(function(o){r.path("/roles")})}}function AgregarAnniosController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/promociones/agregarAnnios/php/getAnniosByPromocion.php",{idPromocion:c.idPromocion}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.annios=a,o.dataLoading=!1,o.totalItems=o.annios.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.annios=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/promociones/agregarAnnios/php/deleteAnnioPromocion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.routeParams=c,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarAnnio=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.annios,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarAreasCreditoController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/promociones/agregarAreasCredito/php/getAreasCreditoByPromocion.php",{idPromocion:c.idPromocion}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.areasCredito=a,o.dataLoading=!1,o.totalItems=o.areasCredito.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.areasCredito=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/promociones/agregarAreasCredito/php/deleteAreaCreditoPromocion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.routeParams=c,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarAreaCredito=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.areasCredito,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}
function AgregarDetalleController(o,e,a,r,n,t,s){function c(){d().then(function(o){l().then(function(o){r.path("/promociones")})})}function l(){var e=t.defer(),a=e.promise;if(o.extrasPromocion.length>0)for(i=0;i<o.extrasPromocion.length;i++){var r={id_promocion:s.idPromocion,id_tecnologia:o.extrasPromocion[i].id};n.post("app/promociones/agregarDetalle/php/agregarExtrasPromocion.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)})}else e.resolve();return a}function d(){var e=t.defer(),a=e.promise;return n.post("app/promociones/agregarDetalle/php/borrarExtras.php",{idPromocion:s.idPromocion}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,e.reject())}).error(function(o,a){console.log(o),e.reject(o)}),a}function p(){var e=t.defer(),a=e.promise;return n.post("app/promociones/agregarDetalle/php/getDetalleById.php",{idPromocion:s.idPromocion}).success(function(a){if(angular.isObject(a)){var r=JSON.parse(a[0]);o.tieneDetalle=!0,o.detalle=r[0],o.id_moneda=r[0].id_moneda,o.id_linea_financiera=r[0].id_linea_financiera,o.id_producto_bancario=r[0].id_producto_bancario,o.id_seccion=r[0].id_seccion,o.id_sub_aplicacion=r[0].id_sub_aplicacion,o.id_factor_seguro_vida=r[0].id_factor_seguro_vida,o.solicitudes=r[0].solicitudes,o.comision_agencia=r[0].comision_agencia,o.precio_gracia=r[0].precio_gracia,o.meses_tasafija=r[0].meses_tasafija,o.gastos=r[0].gastos,o.rcimaximo=r[0].rcimaximo,o.subsidioTasa=r[0].subsidio_tasa,o.compraTasa=r[0].compra_tasa,o.subsidioSeguro=r[0].subsidio_seguro,e.resolve()}else o.tieneDetalle=!1,o.detalle={},console.log("sin datos"),e.resolve()}).error(function(a,r){o.tieneDetalle=!1,console.log(a),e.reject(a)}),a}function u(){var e=t.defer(),a=e.promise,r={id:o.detalle.id,id_promocion:s.idPromocion,id_moneda:o.id_moneda,id_linea_financiera:o.id_linea_financiera,id_producto_bancario:o.id_producto_bancario,id_seccion:o.id_seccion,id_sub_aplicacion:o.id_sub_aplicacion,id_factor_seguro_vida:o.id_factor_seguro_vida,solicitudes:o.solicitudes,comision_agencia:o.comision_agencia,precio_gracia:o.precio_gracia,meses_tasafija:o.meses_tasafija,gastos:o.gastos,rcimaximo:o.rcimaximo,subsidio_tasa:o.subsidioTasa,compra_tasa:o.compraTasa,subsidio_seguro:o.subsidioSeguro};return n.post("app/promociones/agregarDetalle/php/editarDetalle.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}function g(){var e=t.defer(),a=e.promise,r={id_promocion:s.idPromocion,id_moneda:o.id_moneda,id_linea_financiera:o.id_linea_financiera,id_producto_bancario:o.id_producto_bancario,id_seccion:o.id_seccion,id_sub_aplicacion:o.id_sub_aplicacion,id_factor_seguro_vida:o.id_factor_seguro_vida,solicitudes:o.solicitudes,comision_agencia:o.comision_agencia,precio_gracia:o.precio_gracia,meses_tasafija:o.meses_tasafija,gastos:o.gastos,rcimaximo:o.rcimaximo,subsidio_tasa:o.subsidioTasa,compra_tasa:o.compraTasa,subsidio_seguro:o.subsidioSeguro};return n.post("app/promociones/agregarDetalle/php/agregarDetalle.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}function m(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/lineaFinanciera/php/getLineaFinanciera.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.lineasFinanciera=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}function f(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/productoBanco/php/getProductoBanco.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.productosBanco=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}function h(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/seccion/php/getSeccion.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.secciones=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}function P(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/subAplicacion/php/getSubAplicacion.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.subAplicaciones=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){var e=t.defer(),a=e.promise;n.post("app/extras/php/getExtras.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extras=r,e.resolve()}else o.extras=[],console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)})}(),function(){var e=t.defer(),a=e.promise;n.post("app/promociones/agregarDetalle/php/getExtrasByPromocion.php",{idPromocion:s.idPromocion}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.extrasPromocion=r,e.resolve()}else o.extrasPromocion=[],e.reject()}).error(function(o,a){console.log(o),e.reject(o)})}(),function(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/monedas/php/getMonedas.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.monedas=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}().then(function(e){m().then(function(e){f().then(function(e){h().then(function(e){P().then(function(e){p().then(function(e){o.dataLoading=!1})})})})})}),o.agregarExtra=function(){o.extrasPromocion.push(o.nuevoExtra),o.nuevoExtra=""},o.borrarExtra=function(e){o.extrasPromocion.splice(e,1)},o.agregarDetalle=function(){o.dataLoading=!0,o.tieneDetalle?u().then(function(o){c()}):g().then(function(o){c()})}}function AgregarMarcasController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/promociones/agregarMarcas/php/getMarcasByPromocion.php",{idPromocion:c.idPromocion}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.marcas=a,o.dataLoading=!1,o.totalItems=o.marcas.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.marcas=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/promociones/agregarMarcas/php/deleteMarcaPromocion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.routeParams=c,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarMarca=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.marcas,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarPromocionController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise,r={descripcion:o.descripcion,id_tipo_prestamo:o.id_tipo_prestamo,fecha_activacion:o.fecha_activacion,fecha_vencimiento:o.fecha_vencimiento};return i.post("app/promociones/agregarPromocion/agregarPromocion.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarPromocion=function(){o.dataLoading=!0,t().then(function(o){r.path("/promociones")})}}function EditarPromocionController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise,r={id:o.id,descripcion:o.descripcion,fecha_activacion:o.fecha_activacion,fecha_vencimiento:o.fecha_vencimiento,activo:o.activo,defaultvalue:o.defaultValue};return i.post("app/promociones/editarPromocion/php/editarPromocion.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/promociones/editarPromocion/php/getPromocionById.php",{idPromocion:t.idPromocion}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.promocion=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.fecha_activacion=a[0].fecha_activacion,o.fecha_vencimiento=a[0].fecha_vencimiento,o.activo=a[0].activo,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarPromocion=function(){o.dataLoading=!0,s().then(function(o){r.path("/promociones")})}}function AgregarSeccionController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise,r={codigo:o.codigo,descripcion:o.descripcion,tasa1:o.tasa1,tasa2:o.tasa2,tasa3:o.tasa3,plazo1:o.plazo1,plazo2:o.plazo2,plazo3:o.plazo3,porcentaje:o.porcentaje,balloonSaldoFinanciar:o.balloonSaldoFinanciar,balloonPrecioGastos:o.balloonPrecioGastos};return i.post("app/seccion/agregarSeccion/agregarSeccion.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarSeccion=function(){o.dataLoading=!0,t().then(function(o){r.path("/seccion")})}}function EditarSeccionController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise,r={id:o.id,codigo:o.codigo,descripcion:o.descripcion,tasa1:o.tasa1,tasa2:o.tasa2,tasa3:o.tasa3,plazo1:o.plazo1,plazo2:o.plazo2,plazo3:o.plazo3,porcentaje:o.porcentaje,balloonSaldoFinanciar:o.balloonSaldoFinanciar,balloonPrecioGastos:o.balloonPrecioGastos};return i.post("app/seccion/editarSeccion/php/editarSeccion.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/seccion/editarSeccion/php/getSeccionById.php",{idSeccion:t.idSeccion}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.seccion=a[0],o.id=a[0].id,o.codigo=a[0].codigo,o.descripcion=a[0].descripcion,o.tasa1=a[0].tasa1,o.tasa2=a[0].tasa2,o.tasa3=a[0].tasa3,o.plazo1=a[0].plazo1,o.plazo2=a[0].plazo2,o.plazo3=a[0].plazo3,o.porcentaje=a[0].porcentaje,o.balloonSaldoFinanciar=a[0].balloonsaldofinanciar,o.balloonPrecioGastos=a[0].balloonpreciogastos,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarSeccion=function(){o.dataLoading=!0,s().then(function(o){r.path("/seccion")})}}function AgregarSeguroController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise,r={tipo_seguro:o.tipoSeguro,id_tipovehiculo:o.tipoVehiculo,id_usoseguro:o.usoSeguro,rango_inferior:o.rangoInferior,rango_superior:o.rangoSuperior,a:o.tipoA,b:o.tipoB,c:o.tipoC,d:o.tipoD,f:o.tipoF,g:o.tipoG,h:o.tipoH};return i.post("app/seguros/agregarSeguro/agregarSeguro.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarSeguro=function(){o.dataLoading=!0,t().then(function(o){r.path("/seguros")})}}function EditarSeguroController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise,r={id:o.id,tipo_seguro:o.tipo_seguro,id_tipovehiculo:o.id_tipovehiculo,id_usoseguro:o.id_usoseguro,rango_inferior:o.rangoInferior,rango_superior:o.rangoSuperior,a:o.tipoA,b:o.tipoB,c:o.tipoC,d:o.tipoD,f:o.tipoF,g:o.tipoG,h:o.tipoH};return i.post("app/seguros/editarSeguro/php/editarSeguro.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/seguros/editarSeguro/php/getSeguroById.php",{idSeguro:t.idSeguro}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.seguro=a[0],o.id=a[0].id,o.tipo_seguro=a[0].tipo_seguro,o.id_tipovehiculo=a[0].id_tipovehiculo,o.id_usoseguro=a[0].id_usoseguro,o.rangoInferior=a[0].rango_inferior,o.rangoSuperior=a[0].rango_superior,o.tipoA=a[0].a,o.tipoB=a[0].b,o.tipoC=a[0].c,o.tipoD=a[0].d,o.tipoF=a[0].f,o.tipoG=a[0].g,o.tipoH=a[0].h,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarSeguro=function(){o.dataLoading=!0,s().then(function(o){r.path("/seguros")})}}function AgregarSeguroLeasingController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise,r={id_tipovehiculo:o.tipoVehiculo,id_usoseguro:o.usoSeguro,a:o.tipoA,b:o.tipoB,c:o.tipoC,d:o.tipoD,f:o.tipoF,g:o.tipoG,h:o.tipoH};return i.post("app/segurosLeasing/agregarSeguroLeasing/agregarSeguroLeasing.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarSeguroLeasing=function(){o.dataLoading=!0,t().then(function(o){r.path("/segurosLeasing")})}}function EditarSeguroLeasingController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise,r={id:o.id,id_tipovehiculo:o.id_tipovehiculo,id_usoseguro:o.id_usoseguro,a:o.tipoA,b:o.tipoB,c:o.tipoC,d:o.tipoD,f:o.tipoF,g:o.tipoG,h:o.tipoH};return i.post("app/segurosLeasing/editarSeguroLeasing/php/editarSeguroLeasing.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/segurosLeasing/editarSeguroLeasing/php/getSeguroByIdLeasing.php",{idSeguroLeasing:t.idSeguroLeasing}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.seguroLeasing=a[0],o.id=a[0].id,o.id_tipovehiculo=a[0].id_tipovehiculo,o.id_usoseguro=a[0].id_usoseguro,o.tipoA=a[0].a,o.tipoB=a[0].b,o.tipoC=a[0].c,o.tipoD=a[0].d,o.tipoF=a[0].f,o.tipoG=a[0].g,o.tipoH=a[0].h,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarSeguroLeasing=function(){o.dataLoading=!0,s().then(function(o){r.path("/segurosLeasing")})}}function AgregarSubAplicacionController(o,e,a,r,i,n){function t(){var e=n.defer(),a=e.promise;return i.post("app/subAplicacion/agregarSubAplicacion/agregarSubAplicacion.php",{codigo:o.codigo,descripcion:o.descripcion}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.agregarSubAplicacion=function(){o.dataLoading=!0,t().then(function(o){r.path("/subaplicacion")})}}function EditarSubAplicacionController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return i.post("app/subAplicacion/editarSubAplicacion/php/editarSubAplicacion.php",{id:o.id,codigo:o.codigo,descripcion:o.descripcion}).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/subAplicacion/editarSubAplicacion/php/getSubAplicacionById.php",{idSubAplicacion:t.idSubAplicacion}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.subAplicacion=a[0],o.id=a[0].id,o.codigo=a[0].codigo,o.descripcion=a[0].descripcion,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarSubAplicacion=function(){o.dataLoading=!0,s().then(function(o){r.path("/subaplicacion")})}}function AgregarUsuarioController(o,e,a,r,n,t){function s(){var e=t.defer(),a=e.promise,r={login_:o.username,password_:o.contrasena,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,email:o.email,id_genero:o.id_genero,idtipo_usuario:o.idtipo_usuario,telefono:o.telefono};return n.post("app/usuarios/agregarUsuario/agregarUsuario.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?(o.idUsuario=a.last_id,e.resolve()):(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}function c(){d().then(function(o){l().then(function(o){r.path("/usuarios")})})}function l(){var e=t.defer(),a=e.promise;if(o.agenciasUsuario.length>0)for(i=0;i<o.agenciasUsuario.length;i++){var r={id_usuario:o.idUsuario,id_agencia:o.agenciasUsuario[i].id};n.post("app/usuarios/agregarUsuario/php/agregarAgenciasUsuario.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)})}else e.resolve();return a}function d(){var e=t.defer(),a=e.promise;return n.post("app/usuarios/agregarUsuario/php/borrarAgencias.php",{idUsuario:o.idUsuario}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,e.reject())}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,o.agenciasUsuario=[],function(){o.agenciasLoading=!0;var e=t.defer(),a=e.promise;n.post("app/agencias/php/getAgencias.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.agencias=r,o.agenciasLoading=!1,e.resolve()}else o.agencias=[],o.agenciasLoading=!1,console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)})}(),o.agregarAgencia=function(){o.agenciasUsuario.push(o.nuevaAgencia),o.nuevaAgencia=""},o.borrarAgencia=function(e){o.agenciasUsuario.splice(e,1)},o.agregarUsuario=function(){o.dataLoading=!0,s().then(function(o){c()})}}function EditarUsuarioController(o,e,a,r,n,t,s){function c(){var e=t.defer(),a=e.promise,r={id:o.id,login_:o.username,password_:o.contrasena,nombre:o.nombre,apellido1:o.apellido1,apellido2:o.apellido2,email:o.email,id_genero:o.id_genero,idtipo_usuario:o.idtipo_usuario,telefono:o.telefono};return n.post("app/usuarios/editarUsuario/php/editarUsuario.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}function l(){p().then(function(o){d().then(function(o){r.path("/usuarios")})})}function d(){var e=t.defer(),a=e.promise;if(o.agenciasUsuario.length>0)for(i=0;i<o.agenciasUsuario.length;i++){var r={id_usuario:s.idUsuario,id_agencia:o.agenciasUsuario[i].id};n.post("app/usuarios/agregarUsuario/php/agregarAgenciasUsuario.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)})}else e.resolve();return a}function p(){var e=t.defer(),a=e.promise;return n.post("app/usuarios/agregarUsuario/php/borrarAgencias.php",{idUsuario:s.idUsuario}).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,e.reject())}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,n.post("app/usuarios/editarUsuario/php/getUsuarioById.php",{idUsuario:s.idUsuario}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.usuario=a[0],o.id=a[0].id,o.username=a[0].login_,o.contrasena=a[0].password_,o.nombre=a[0].nombre,o.apellido1=a[0].apellido1,o.apellido2=a[0].apellido2,o.email=a[0].email,o.id_genero=a[0].id_genero,o.idtipo_usuario=a[0].idtipo_usuario,o.telefono=a[0].telefono,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),function(){o.agenciasLoading=!0;var e=t.defer(),a=e.promise;n.post("app/agencias/php/getAgencias.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.agencias=r,o.agenciasLoading=!1,e.resolve()}else o.agencias=[],o.agenciasLoading=!1,console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)})}(),function(){var e=t.defer(),a=e.promise;n.post("app/usuarios/editarUsuario/php/getAgenciasByUsuario.php",{idUsuario:s.idUsuario}).success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.agenciasUsuario=r,e.resolve()}else o.agenciasUsuario=[],e.reject()}).error(function(o,a){console.log(o),e.reject(o)})}(),o.agregarAgencia=function(){o.agenciasUsuario.push(o.nuevaAgencia),o.nuevaAgencia=""},o.borrarAgencia=function(e){o.agenciasUsuario.splice(e,1)},o.editarUsuario=function(){o.dataLoading=!0,c().then(function(o){l()})}}function EditarVariableController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise,r={id:o.id,cambio_dolar:o.cambio_dolar,cambio_dolar_seguros:o.cambio_dolar_seguros,tasa1:o.tasa1,tasa2:o.tasa2,prima:o.prima,comision:o.comision,plazo1:o.plazo1,plazo2:o.plazo2,factorSeguro:o.factorSeguro,rci:o.rci};return i.post("app/variables/editarVariable/php/editarVariable.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0,i.post("app/variables/editarVariable/php/getVariableById.php",{idVariable:t.idVariable}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.variable=a[0],o.id=a[0].id,o.cambio_dolar=a[0].cambio_dolar,o.cambio_dolar_seguros=a[0].cambio_dolar_seguros,o.tasa1=a[0].tasa1,o.tasa2=a[0].tasa2,o.prima=a[0].prima,o.comision=a[0].comision,o.plazo1=a[0].plazo1,o.plazo2=a[0].plazo2,o.factorSeguro=a[0].factorSeguro,o.rci=a[0].rci,o.dataLoading=!1}else console.log("sin datos"),o.dataLoading=!1}).error(function(o,e){console.log(o)})}(),o.editarVariable=function(){o.dataLoading=!0,s().then(function(o){r.path("/variables")})}}function AgregarDetalleAlAreaController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise,r={id_tipoventas:t.idAreaCredito,descripcion:o.descripcion,moneda:o.moneda,monto:o.monto,porcentaje:o.porcentaje,tipocalculo:o.tipocalculo,tipocampo:o.tipocampo};return i.post("app/areasCredito/agregarDetallesAlArea/agregarDetalleAlArea/agregarDetalleAlArea.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.routeParams=t,o.agregarDetalleAlArea=function(){o.dataLoading=!0,s().then(function(o){r.path("/area-credito-agregar-detalle/"+t.idAreaCredito)})}}function EditarDetalleAlAreaController(o,e,a,r,i,n,t){function s(){var e=n.defer(),a=e.promise;return detalle={id:t.idDetalle,descripcion:o.descripcion,moneda:o.moneda,monto:o.monto,porcentaje:o.porcentaje,tipocalculo:o.tipocalculo,tipocampo:o.tipocampo},i.post("app/areasCredito/agregarDetallesAlArea/editarDetalleAlArea/php/editarDetalle.php",detalle).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){i.post("app/areasCredito/agregarDetallesAlArea/editarDetalleAlArea/php/getDetalleById.php",{idDetalle:t.idDetalle}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.detalle=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.moneda=a[0].moneda,o.monto=a[0].monto,o.porcentaje=a[0].porcentaje,o.tipocalculo=a[0].tipocalculo,o.tipocampo=a[0].tipocampo}else console.log("sin datos")}).error(function(o,e){console.log(o)})}(),o.editarDetalleAlArea=function(){o.dataLoading=!0,s().then(function(e){r.path("/area-credito-agregar-detalle/"+o.detalle.id_tipoventas)})}}function AgregarModeloController(o,e,a,r,n,t,s){function c(){var e=t.defer(),a=e.promise,r={descripcion:s.descripcionMarca,modelo:o.modelo,tipovehiculo:o.tipovehiculo,tipofinanciamiento:o.tipofinanciamiento};return n.post("app/marcas/agregarModelos/agregarModelo/agregarModelo.php",r).success(function(a){angular.isObject(a)&&a.jsonSuccess?e.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,e.reject(o.error))}).error(function(a,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(a),e.reject(a)}),a}o.imgLoading=a.img,o.routeParams=s,function(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/marcas/agregarModelos/agregarModelo/php/getTiposVehiculo.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.tiposVehiculo=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}().then(function(e){o.dataLoading=!1}),o.agregarModelo=function(){o.dataLoading=!0,c().then(function(o){r.path("/agregar-modelos/"+s.descripcionMarca)})}}function EditarModeloController(o,e,a,r,n,t,s){function c(){n.post("app/marcas/agregarModelos/editarModelo/php/getModeloById.php",{idModelo:s.idModelo}).success(function(e){if(angular.isObject(e)){var a=JSON.parse(e);o.modelo=a[0],o.id=a[0].id,o.descripcion=a[0].descripcion,o.modelo=a[0].modelo,o.tipovehiculo=a[0].tipovehiculo,o.tipofinanciamiento=a[0].tipofinanciamiento,o.dataLoading=!1}else console.log("sin datos")}).error(function(o,e){console.log(o)})}function l(){var e=t.defer(),a=e.promise,r={id:o.id,descripcion:o.descripcion,modelo:o.modelo,tipovehiculo:o.tipovehiculo,tipofinanciamiento:o.tipofinanciamiento};return n.post("app/marcas/agregarModelos/editarModelo/editarModelo.php",r).success(function(o){angular.isObject(o)&&o.jsonSuccess?e.resolve():e.resolve(o)}).error(function(o,a){console.log(o),e.reject(o)}),a}o.imgLoading=a.img,function(){o.dataLoading=!0;var e=t.defer(),a=e.promise;return n.post("app/marcas/agregarModelos/agregarModelo/php/getTiposVehiculo.php").success(function(a){if(angular.isObject(a)){var r=[];for(i=0;i<a.length;i++){var n=JSON.parse(a[i]);r.push(n[0])}o.tiposVehiculo=r,e.resolve()}else console.log("sin datos"),e.reject()}).error(function(o,a){console.log(o),e.reject(o)}),a}().then(function(o){c()}),o.editarModelo=function(){o.dataLoading=!0,l().then(function(e){r.path("/agregar-modelos/"+o.descripcion)})}}function AgregarPantallaAlRolController(o,e,a,r,i,n,t,s){function c(e){var a=n.defer(),r=a.promise,s={id_roles:t.idRol,id_pantalla:e};return i.post("app/roles/agregarPantallasAlRol/agregarPantallaAlRol/php/agregarPantallaAlRol.php",s).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}o.imgLoading=a.img,o.routeParams=t,o.currentPage=0,o.pageSize=10,o.search={},function(){o.dataLoading=!0,o.pantallas=[{id_pantalla:"agencias",nombre:"Agencias"},{id_pantalla:"annos",nombre:"AÃ±os"},{id_pantalla:"areascredito",nombre:"Areas de Credito"},{id_pantalla:"bandejaadministrador",nombre:"Bandeja de Administrador"},{id_pantalla:"bandejaentrada",nombre:"Bandeja de Entrada"},{id_pantalla:"bandejaleads",nombre:"Bandeja de Leads"},{id_pantalla:"bandejavendedor",nombre:"Bandeja de Vendedor"},{id_pantalla:"bonificaciones",nombre:"Bonificaciones"},{id_pantalla:"ejecutivo",nombre:"Ejecutivo"},{id_pantalla:"lineafinanciera",nombre:"Linea Financiera"},{id_pantalla:"marcas",nombre:"Marcas"},{id_pantalla:"monedas",nombre:"Monedas"},{id_pantalla:"productobanco",nombre:"Producto Banco"},{id_pantalla:"promociones",nombre:"Promociones"},{id_pantalla:"roles",nombre:"Roles"},{id_pantalla:"seccion",nombre:"Seccion"},{id_pantalla:"seguros",nombre:"Seguros"},{id_pantalla:"segurosLeasing",nombre:"Seguros Leasing"},{id_pantalla:"subaplicacion",nombre:"Sub Aplicacion"},{id_pantalla:"extras",nombre:"Extras"},{id_pantalla:"usuarios",nombre:"Usuarios"},{id_pantalla:"variables",nombre:"Variables"},{id_pantalla:"vendedor",nombre:"Vendedor"}],o.dataLoading=!1,o.totalItems=o.pantallas.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}(),o.agregarPantallaAlRol=function(e){o.dataLoading=!0,c(e).then(function(e){o.dataLoading=!1})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.pantallas,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarUsuarioAlRolController(o,e,a,r,n,t,s,c){function l(e){var a=t.defer(),r=a.promise,i={id_roles:s.idRol,id_usuario:e};return n.post("app/roles/agregarUsuariosAlRol/agregarUsuarioAlRol/php/agregarUsuarioAlRol.php",i).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}o.imgLoading=a.img,o.routeParams=s,o.currentPage=0,o.pageSize=10,o.search={},function(){o.dataLoading=!0,n.post("app/usuarios/php/getUsuarios.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.usuarios=a,o.dataLoading=!1,o.totalItems=o.usuarios.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.usuarios=[]}).error(function(o,e){console.log(o)})}(),o.agregarUsuarioAlRol=function(e){o.dataLoading=!0,l(e).then(function(e){o.dataLoading=!1})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.usuarios,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarAnnioPromocionController(o,e,a,r,n,t,s,c){function l(e){var a=t.defer(),r=a.promise,i={id_promocion:s.idPromocion,anno:e};return n.post("app/promociones/agregarAnnios/agregarAnnio/php/agregarAnnioPromocion.php",i).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}o.imgLoading=a.img,o.routeParams=s,o.currentPage=0,o.pageSize=10,o.search={},function(){o.dataLoading=!0,n.post("app/annios/php/getAnnios.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.annios=a,o.dataLoading=!1,o.totalItems=o.annios.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.annios=[]}).error(function(o,e){console.log(o)})}(),o.agregarAnnioPromocion=function(e){o.dataLoading=!0,l(e).then(function(e){o.dataLoading=!1})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.annios,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarAreaCreditoPromocionController(o,e,a,r,n,t,s,c){function l(e){var a=t.defer(),r=a.promise,i={id_promocion:s.idPromocion,id_tipoventa:e};return n.post("app/promociones/agregarAreasCredito/agregarAreaCredito/php/agregarAreaCreditoPromocion.php",i).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}o.imgLoading=a.img,o.routeParams=s,o.currentPage=0,o.pageSize=10,o.search={},function(){o.dataLoading=!0,n.post("app/areasCredito/php/getAreasCredito.php").success(function(e){
if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.areasCredito=a,o.dataLoading=!1,o.totalItems=o.areasCredito.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.areasCredito=[]}).error(function(o,e){console.log(o)})}(),o.agregarAreaCreditoPromocion=function(e){o.dataLoading=!0,l(e).then(function(e){o.dataLoading=!1})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.areasCredito,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarMarcaPromocionController(o,e,a,r,n,t,s,c){function l(e){var a=t.defer(),r=a.promise,i={id_promocion:s.idPromocion,id_marca:e};return n.post("app/promociones/agregarMarcas/agregarMarca/php/agregarMarcaPromocion.php",i).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}o.imgLoading=a.img,o.routeParams=s,o.currentPage=0,o.pageSize=10,o.search={},function(){o.dataLoading=!0,n.post("app/marcas/php/getMarcas.php").success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.marcas=a,o.dataLoading=!1,o.totalItems=o.marcas.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.marcas=[]}).error(function(o,e){console.log(o)})}(),o.agregarMarcaPromocion=function(e){o.dataLoading=!0,l(e).then(function(e){o.dataLoading=!1})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.marcas,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarMarcasModelosController(o,e,a,r,n,t,s,c){function l(){o.dataLoading=!0,n.post("app/promociones/agregarMarcas/agregarModelos/php/getModelosByPromocion.php",{idMarca:c.idMarca,idPromocion:c.idPromocion}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,o.dataLoading=!1,o.totalItems=o.modelos.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.modelos=[],o.dataLoading=!1}).error(function(o,e){console.log(o)})}function d(e){var a=t.defer(),r=a.promise;return n.post("app/promociones/agregarMarcas/agregarModelos/php/deleteModeloPromocion.php",{id:e}).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(alert("No se puede eliminar"),o.dataLoading=!1,a.reject())}).error(function(o,e){console.log(o),a.reject(o)}),r}o.imgLoading=a.img,o.routeParams=c,o.currentPage=0,o.pageSize=10,o.search={},l(),o.borrarModelo=function(e){o.dataLoading=!0,d(e).then(function(o){l()})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=s(o.modelos,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}function AgregarModeloPromocionController(o,e,a,r,n,t,s,c){function l(e){var a=t.defer(),r=a.promise,i={id_promocion:s.idPromocion,id_marca:s.idMarca,modelo:e};return n.post("app/promociones/agregarMarcas/agregarModelos/agregarModelo/php/agregarModeloPromocion.php",i).success(function(e){angular.isObject(e)&&e.jsonSuccess?a.resolve():(o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error))}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}function d(e){o.dataLoading=!0,n.post("app/marcas/agregarModelos/php/getModelos.php",{descripcionMarca:e}).success(function(e){if(angular.isObject(e)){var a=[];for(i=0;i<e.length;i++){var r=JSON.parse(e[i]);a.push(r[0])}o.modelos=a,o.dataLoading=!1,o.totalItems=o.modelos.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize)}else o.modelos=[]}).error(function(o,e){console.log(o)})}o.imgLoading=a.img,o.routeParams=s,o.currentPage=0,o.pageSize=10,o.search={},function(e){var a=t.defer(),r=a.promise;return n.post("app/marcas/editarMarca/php/getMarcaById.php",{idMarca:e}).success(function(e){if(angular.isObject(e)){var r=JSON.parse(e[0]);a.resolve(r[0].descripcion)}else o.error="Datos incorrectos",o.dataLoading=!1,a.reject(o.error)}).error(function(e,r){o.error="Datos incorrectos",o.dataLoading=!1,console.log(e),a.reject(e)}),r}(s.idMarca).then(function(o){d(o)}),o.agregarTodosModelos=function(){for(o.dataLoading=!0,i=0;i<o.modelos.length;i++)o.dataLoading=!0,l(o.modelos[i].modelo).then(function(e){o.dataLoading=!1})},o.agregarModeloPromocion=function(e){o.dataLoading=!0,l(e).then(function(e){o.dataLoading=!1})},o.resetFilters=function(){o.search={}},o.$watch("search",function(e,a){o.filtered=c(o.modelos,e),o.filtered&&(o.totalItems=o.filtered.length,o.noOfPages=Math.ceil(o.totalItems/o.pageSize),o.currentPage=0)},!0)}angular.module("Cotizador").controller("AgenciasController",AgenciasController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgenciasController.$inject=["$scope","$rootScope","loading","$location","$http","$q","localStorageService","filterFilter"],angular.module("Cotizador").controller("AnniosController",AnniosController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AnniosController.$inject=["$scope","$rootScope","loading","$location","$http","$q","localStorageService","filterFilter"],angular.module("Cotizador").controller("BandejaAdministradorController",BandejaAdministradorController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),BandejaAdministradorController.$inject=["$scope","$rootScope","loading","$location","$http","localStorageService","filterFilter"],angular.module("Cotizador").controller("AreasCreditoController",AreasCreditoController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AreasCreditoController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("BandejaController",BandejaController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),BandejaController.$inject=["$scope","$rootScope","loading","$location","$http","localStorageService","filterFilter"],angular.module("Cotizador").controller("BandejaLeadsController",BandejaLeadsController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),BandejaLeadsController.$inject=["$scope","$rootScope","loading","$location","$http","localStorageService","filterFilter"],angular.module("Cotizador").controller("BandejaVendedorController",BandejaVendedorController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),BandejaVendedorController.$inject=["$scope","$rootScope","loading","$location","$http","localStorageService","filterFilter"],angular.module("Cotizador").controller("BonificacionesController",BonificacionesController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),BonificacionesController.$inject=["$scope","$rootScope","loading","$location","$http","$q","localStorageService","filterFilter"],angular.module("Cotizador").controller("EjecutivoController",EjecutivoController),EjecutivoController.$inject=["$scope","$rootScope","loading","$location","$http","$q","correoService","calcularFormulasService","impresionClienteService","impresionAnalistaService","impresionPreAprobacionService","impresionNoPreAprobacionService","impresionClienteLeasingFinancieroService","impresionClienteLeasingOperativoService","impresionAnalistaLeasingOperativoService","impresionAnalistaLeasingFinancieroService"],angular.module("Cotizador").controller("ExtrasController",ExtrasController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),ExtrasController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("HomeController",HomeController),HomeController.$inject=["$scope","$rootScope"],angular.module("Cotizador").controller("LineaFinancieraController",LineaFinancieraController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),LineaFinancieraController.$inject=["$scope","$rootScope","loading","$location","$http","$q","localStorageService","filterFilter"],angular.module("Cotizador").controller("LoginController",LoginController),LoginController.$inject=["$scope","$rootScope","loading","$location","$http","$q","localStorageService","$crypto"],angular.module("Cotizador").controller("MarcasController",MarcasController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),MarcasController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("MonedasController",MonedasController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),MonedasController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("PasswordController",PasswordController),PasswordController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("ProductoBancoController",ProductoBancoController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),ProductoBancoController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("RolesController",RolesController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),RolesController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("PromocionesController",PromocionesController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),PromocionesController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("SeccionController",SeccionController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),SeccionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("SegurosController",SegurosController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),SegurosController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("SegurosLeasingController",SegurosLeasingController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),SegurosLeasingController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("SubAplicacionController",SubAplicacionController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),SubAplicacionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("UsuariosController",UsuariosController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),UsuariosController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter"],angular.module("Cotizador").controller("VendedorController",VendedorController),VendedorController.$inject=["$scope","$rootScope","loading","$location","$http","$q","correoService","calcularFormulasService","impresionClienteService","impresionPreAprobacionService","impresionNoPreAprobacionService","impresionClienteLeasingFinancieroService","impresionClienteLeasingOperativoService"],angular.module("Cotizador").controller("VariablesController",VariablesController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),VariablesController.$inject=["$scope","$rootScope","loading","$location","$http","$q","localStorageService","filterFilter"],angular.module("Cotizador").controller("AgregarAgenciaController",AgregarAgenciaController),AgregarAgenciaController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarAgenciaController",EditarAgenciaController),EditarAgenciaController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarAnnioController",AgregarAnnioController),AgregarAnnioController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarAnnioController",EditarAnnioController),EditarAnnioController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("DetalleAdministradorController",DetalleAdministradorController),DetalleAdministradorController.$inject=["$scope","$rootScope","$location","$http","$routeParams","$q","calcularFormulasService","correoService","impresionClienteService","impresionAnalistaService","$crypto","impresionClienteLeasingOperativoService","impresionClienteLeasingFinancieroService","impresionAnalistaLeasingOperativoService","impresionAnalistaLeasingFinancieroService"],angular.module("Cotizador").controller("AgregarAreaCreditoController",AgregarAreaCreditoController),AgregarAreaCreditoController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("agregarDetallesAlAreaController",agregarDetallesAlAreaController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),agregarDetallesAlAreaController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("EditarAreaCreditoController",EditarAreaCreditoController),EditarAreaCreditoController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("DetalleController",DetalleController),DetalleController.$inject=["$scope","$rootScope","$location","$http","$routeParams","$q","calcularFormulasService","correoService","impresionClienteService","impresionAnalistaService","$crypto","impresionClienteLeasingOperativoService","impresionClienteLeasingFinancieroService","impresionAnalistaLeasingOperativoService","impresionAnalistaLeasingFinancieroService"],angular.module("Cotizador").controller("DetalleLeadsController",DetalleLeadsController),DetalleLeadsController.$inject=["$scope","$rootScope","$location","$http","$routeParams","$q","calcularFormulasService","correoService","impresionClienteService","impresionAnalistaService","$crypto"],angular.module("Cotizador").controller("DetalleVendedorController",DetalleVendedorController),DetalleVendedorController.$inject=["$scope","$rootScope","$location","$http","$routeParams","$q","calcularFormulasService","correoService","impresionClienteService","impresionAnalistaService","$crypto","impresionClienteLeasingOperativoService","impresionClienteLeasingFinancieroService"],angular.module("Cotizador").controller("AgregarBonificacionController",AgregarBonificacionController),AgregarBonificacionController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarBonificacionController",EditarBonificacionController),EditarBonificacionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").directive("encabezado",encabezado).controller("EncabezadoController",EncabezadoController),EncabezadoController.$inject=["$scope","$rootScope","$route","$location","$http","$q","localStorageService","$crypto"],angular.module("Cotizador").directive("menuRoles",menuRoles).controller("MenuRolesController",MenuRolesController),MenuRolesController.$inject=["$scope","$rootScope","loading","$location","$route"],angular.module("Cotizador").controller("AgregarExtraController",AgregarExtraController),AgregarExtraController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarExtraController",EditarExtraController),EditarExtraController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarLineaFinancieraController",AgregarLineaFinancieraController),AgregarLineaFinancieraController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarLineaFinancieraController",EditarLineaFinancieraController),EditarLineaFinancieraController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarMarcaController",AgregarMarcaController),AgregarMarcaController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("AgregarModelosController",AgregarModelosController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarModelosController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("EditarMarcaController",EditarMarcaController),EditarMarcaController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarMonedaController",AgregarMonedaController),AgregarMonedaController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarMonedaController",EditarMonedaController),EditarMonedaController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarProductoBancoController",AgregarProductoBancoController),AgregarProductoBancoController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarProductoBancoController",EditarProductoBancoController),EditarProductoBancoController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarPantallasAlRolController",AgregarPantallasAlRolController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarPantallasAlRolController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("AgregarRolController",AgregarRolController),AgregarRolController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("AgregarUsuariosAlRolController",AgregarUsuariosAlRolController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarUsuariosAlRolController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("EditarRolController",EditarRolController),EditarRolController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarAnniosController",AgregarAnniosController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarAnniosController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("AgregarAreasCreditoController",AgregarAreasCreditoController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarAreasCreditoController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("AgregarDetalleController",AgregarDetalleController),AgregarDetalleController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarMarcasController",AgregarMarcasController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarMarcasController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("AgregarPromocionController",AgregarPromocionController),AgregarPromocionController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarPromocionController",EditarPromocionController),EditarPromocionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarSeccionController",AgregarSeccionController),AgregarSeccionController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarSeccionController",EditarSeccionController),EditarSeccionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarSeguroController",AgregarSeguroController),AgregarSeguroController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarSeguroController",EditarSeguroController),EditarSeguroController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarSeguroLeasingController",AgregarSeguroLeasingController),AgregarSeguroLeasingController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarSeguroLeasingController",EditarSeguroLeasingController),EditarSeguroLeasingController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarSubAplicacionController",AgregarSubAplicacionController),AgregarSubAplicacionController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarSubAplicacionController",EditarSubAplicacionController),EditarSubAplicacionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarUsuarioController",AgregarUsuarioController),AgregarUsuarioController.$inject=["$scope","$rootScope","loading","$location","$http","$q"],angular.module("Cotizador").controller("EditarUsuarioController",EditarUsuarioController),EditarUsuarioController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("EditarVariableController",EditarVariableController),EditarVariableController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarDetalleAlAreaController",AgregarDetalleAlAreaController),AgregarDetalleAlAreaController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("EditarDetalleAlAreaController",EditarDetalleAlAreaController),EditarDetalleAlAreaController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarModeloController",AgregarModeloController),AgregarModeloController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("EditarModeloController",EditarModeloController),EditarModeloController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams"],angular.module("Cotizador").controller("AgregarPantallaAlRolController",AgregarPantallaAlRolController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarPantallaAlRolController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams","filterFilter"],angular.module("Cotizador").controller("AgregarUsuarioAlRolController",AgregarUsuarioAlRolController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarUsuarioAlRolController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams","filterFilter"],angular.module("Cotizador").controller("AgregarAnnioPromocionController",AgregarAnnioPromocionController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarAnnioPromocionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams","filterFilter"],angular.module("Cotizador").controller("AgregarAreaCreditoPromocionController",AgregarAreaCreditoPromocionController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarAreaCreditoPromocionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams","filterFilter"],angular.module("Cotizador").controller("AgregarMarcaPromocionController",AgregarMarcaPromocionController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarMarcaPromocionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams","filterFilter"],angular.module("Cotizador").controller("AgregarMarcasModelosController",AgregarMarcasModelosController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarMarcasModelosController.$inject=["$scope","$rootScope","loading","$location","$http","$q","filterFilter","$routeParams"],angular.module("Cotizador").controller("AgregarModeloPromocionController",AgregarModeloPromocionController).filter("startFrom",function(){return function(o,e){if(angular.isObject(o))return e=+e,o.slice(e)}}),AgregarModeloPromocionController.$inject=["$scope","$rootScope","loading","$location","$http","$q","$routeParams","filterFilter"];